{"version":3,"file":"CS4fbdz6.js","sources":["../../../resources/js/Pages/Dashboard/komdis/Page.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { usePage, router } from \"@inertiajs/react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\nimport { Breadcrumbs } from \"@/Components/ui/breadcrumbs\";\nimport { Button } from \"@/Components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/Components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/Components/ui/tabs\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Textarea } from \"@/Components/ui/textarea\";\nimport { IconEdit, IconTrash } from \"@tabler/icons-react\";\n\nconst breadcrumbItems = [\n  { title: \"Ellysion Panel\", link: \"/dashboard\" },\n  { title: \"Komdis\", link: \"/dashboard/komdis\" },\n];\n\nexport default function Page({ auth, logs, userData: initialUserData, redirectToInput }: any) {\n  const [tab, setTab] = useState(redirectToInput ? \"input\" : \"list\");\n  const [userData, setUserData] = useState<any>(initialUserData || null);\n  const [kesalahan, setKesalahan] = useState(\"\");\n\n  // Handler untuk edit\n  const handleEdit = (logId: number) => {\n    router.get(route('dashboard.komdis.edit', logId));\n  };\n\n  // Handler untuk hapus\n  const handleDelete = (logId: number) => {\n    if (confirm('Yakin ingin menghapus data komdis ini?')) {\n      router.delete(route('dashboard.komdis.destroy', logId), {\n        onSuccess: () => {\n          // Refresh halaman atau update state\n          window.location.reload();\n        },\n        onError: (errors) => {\n          alert('Gagal menghapus data');\n        }\n      });\n    }\n  };\n\n  const handleSubmit = (e: any) => {\n    e.preventDefault();\n\n    router.post(\n      \"/dashboard/komdis/store\", // Perbaiki route\n      {\n        user_id: userData.id,\n        kesalahan,\n      },\n      {\n        onSuccess: () => {\n          setKesalahan(\"\");\n          setUserData(null);\n          setTab(\"list\");\n        },\n        onError: (errors) => {\n          console.error('Submit errors:', errors);\n          alert(errors.kesalahan || \"Terjadi kesalahan\");\n        },\n      }\n    );\n  };\n\n  return (\n    <DashboardLayout user={auth.user}>\n      <h2 className=\"text-3xl font-bold tracking-tight mb-4\">Log Komdis</h2>\n\n      <Breadcrumbs items={breadcrumbItems} />\n\n      <Tabs defaultValue=\"list\" value={tab} onValueChange={setTab} className=\"mt-4\">\n        <TabsList>\n          <TabsTrigger value=\"list\">Daftar Pelanggaran</TabsTrigger>\n          <TabsTrigger value=\"scan\">Scan QR</TabsTrigger>\n          {userData && <TabsTrigger value=\"input\">Isi Kesalahan</TabsTrigger>}\n        </TabsList>\n\n        <TabsContent value=\"list\">\n          <Card className=\"mt-4\">\n            <CardHeader>\n              <CardTitle>Data Pelanggaran</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead>\n                    <tr className=\"text-left border-b\">\n                      <th className=\"p-2\">Nama</th>\n                      <th className=\"p-2\">NIM</th>\n                      <th className=\"p-2\">Kesalahan</th>\n                      <th className=\"p-2\">Status</th>\n                      <th className=\"p-2\">Tanggal</th>\n                      <th className=\"p-2\">Aksi</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {logs.map((log: any) => (\n                      <tr key={log.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"p-2\">{log.user?.name}</td>\n                        <td className=\"p-2\">{log.user?.nim}</td>\n                        <td className=\"p-2\">{log.kesalahan}</td>\n                        <td className=\"p-2\">\n                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                            log.status === 'selesai' ? 'bg-green-100 text-green-800' :\n                            log.status === 'proses' ? 'bg-yellow-100 text-yellow-800' :\n                            'bg-gray-100 text-gray-800'\n                          }`}>\n                            {log.status || 'belum diproses'}\n                          </span>\n                        </td>\n                        <td className=\"p-2\">\n                          {new Date(log.created_at).toLocaleDateString('id-ID')}\n                        </td>\n                        <td className=\"p-2\">\n                          <div className=\"flex gap-2\">\n                            <Button\n                              size=\"sm\"\n                              onClick={() => handleEdit(log.id)}\n                              className=\"bg-gray-900 hover:bg-gray-800 text-white border-0 px-3 py-1.5 rounded-md\"\n                            >\n                              {/* <IconEdit size={16} className=\"mr-1\" /> */}\n                              Edit\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              onClick={() => handleDelete(log.id)}\n                              className=\"bg-red-500 hover:bg-red-600 text-white border-0 px-3 py-1.5 rounded-md\"\n                            >\n                              {/* <IconTrash size={16} className=\"mr-1\" /> */}\n                              Delete\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"scan\">\n          <div className=\"space-y-4\">\n            {/* QR Scanner hanya */}\n            <Card className=\"mt-4\">\n              <CardHeader>\n                <CardTitle>Scan QR Code dengan Kamera</CardTitle>\n              </CardHeader>\n              <CardContent className=\"text-center\">\n                <p className=\"text-gray-600 mb-4\">\n                  Klik tombol di bawah untuk membuka halaman QR scanner\n                </p>\n                <Button \n                  onClick={() => router.get(route('dashboard.komdis.scanner'))}\n                  className=\"w-full\"\n                  size=\"lg\"\n                >\n                  ðŸ“· Buka QR Scanner\n                </Button>\n                <div className=\"text-xs text-gray-500 mt-4 space-y-1\">\n                  <p>â€¢ Scanner akan membuka halaman terpisah</p>\n                  <p>â€¢ Arahkan kamera ke QR code mahasiswa</p>\n                  <p>â€¢ Hasil scan otomatis akan kembali ke halaman ini</p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"input\">\n          <Card className=\"mt-4\">\n            <CardHeader>\n              <CardTitle>\n                Isi Kesalahan untuk {userData?.name || userData?.nama} ({userData?.nim})\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">\n                    Kesalahan/Pelanggaran:\n                  </label>\n                  <Textarea\n                    placeholder=\"Masukkan detail kesalahan atau pelanggaran yang dilakukan\"\n                    value={kesalahan}\n                    onChange={(e) => setKesalahan(e.target.value)}\n                    required\n                    rows={4}\n                  />\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button type=\"submit\" disabled={!kesalahan.trim()}>\n                    Simpan Data\n                  </Button>\n                  <Button \n                    type=\"button\" \n                    variant=\"outline\"\n                    onClick={() => {\n                      setUserData(null);\n                      setKesalahan(\"\");\n                      setTab(\"scan\");\n                    }}\n                  >\n                    Batal\n                  </Button>\n                </div>\n              </form>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </DashboardLayout>\n  );\n}"],"names":["breadcrumbItems","title","link","Page","auth","logs","userData","initialUserData","redirectToInput","tab","setTab","useState","setUserData","kesalahan","setKesalahan","jsxs","DashboardLayout","user","children","jsx","className","Breadcrumbs","items","Tabs","defaultValue","value","onValueChange","TabsList","TabsTrigger","TabsContent","Card","CardHeader","CardTitle","CardContent","map","log","name","nim","status","Date","created_at","toLocaleDateString","Button","size","onClick","handleEdit","logId","id","router","get","route","handleDelete","confirm","delete","onSuccess","window","location","reload","onError","errors","alert","nama","onSubmit","e","preventDefault","post","user_id","console","error","Textarea","placeholder","onChange","target","required","rows","type","disabled","trim","variant"],"mappings":"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"}