import{W as e,j as a,y as s,r as t}from"./Cazw6VBB.js";import i from"./HLt6Kdnn.js";import{D as r}from"./XLk5z4jz.js";import{A as n,a as l,b as d,c as o,d as c,e as m,f as h,g as j,h as x}from"./C0Kw1-g3.js";import{B as p}from"./DaeEVyHU.js";import{D as u,f as g,a as f,b,c as k,d as w,g as y,e as v}from"./CekJPCEn.js";import{L as N}from"./u6U27Q2C.js";import{T as _}from"./Cif8pLSY.js";import{t as z}from"./CX-7ZgcB.js";import{D as I}from"./BhYQHNs2.js";import{S as L}from"./Dwllg1KQ.js";import{B as K}from"./xKHUMm2E.js";import{C as S,b as A,c as M,a as C}from"./BV6lnmO-.js";import{S as D,a as P,b as E,c as F,d as B,e as H,f as T}from"./8T8S-82V.js";import{T as G,b as O,c as R,a as V}from"./uSgnzAz5.js";import{T as W}from"./BwCNSijY.js";import{u as q}from"./KqV_aZES.js";import"./CXzfxgOl.js";import"./DovTLYjG.js";import"./Dqw-ucgh.js";import"./DlbJ-Hzm.js";import"./BjW7b6if.js";import"./BwMU5Rmg.js";import"./DKlZK520.js";import"./Dcj1hihR.js";import"./B35kdCLD.js";import"./BTtprT4W.js";import"./BWAKTBD8.js";import"./DWvKkqnp.js";import"./44XEV6fE.js";import"./CawTscPd.js";import"./DztVUfFD.js";import"./Rno_6PHR.js";import"./B7pk4ETx.js";const J=({data:t})=>{const{data:i,setData:r}=e({id:t.id,kehadiran:"",keterangan:"",date:t.date});return a.jsx(a.Fragment,{children:!1===t.action?null:a.jsxs("div",{className:"flex gap-1 p-2",children:[a.jsxs(n,{children:[a.jsx(l,{asChild:!0,children:a.jsx(p,{size:"sm",children:"Absen"})}),a.jsxs(d,{children:[a.jsxs(o,{children:[a.jsxs(c,{children:["Apakah Anda yakin ingin meng-Absen ",t.user.name]}),a.jsx(m,{children:"Aksi ini akan mengubah status maba menjadi hadir."})]}),a.jsxs(h,{children:[a.jsx(j,{children:"Cancel"}),a.jsx(x,{onClick:()=>{"Hadir"!==t.user.status?s.post(route("dashboard.presensi.absen"),{...i,kehadiran:"Hadir"}):z({title:"Gagal",description:`Maba ${t.user.name} sudah hadir`,variant:"destructive"})},children:"Continue"})]})]})]}),"Izin"!==t.user.status?a.jsxs(u,{children:[a.jsx(g,{asChild:!0,children:a.jsx(p,{className:"gap-2",size:"sm",variant:"outline",children:"Set Izin"})}),a.jsxs(f,{className:"sm:max-w-[425px]",children:[a.jsxs(b,{children:[a.jsxs(k,{children:["Ingin Set Izin ",t.user.name," ?"]}),a.jsx(w,{children:"Isi bagian catatan dan aksi ini akan mengubah status maba menjadi izin"})]}),a.jsx("div",{className:"grid gap-4 py-4",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx(N,{htmlFor:"asnwer",className:"text-left",children:"Catatan"}),a.jsx(_,{id:"asnwer",value:i.keterangan,onChange:e=>r("keterangan",e.target.value),placeholder:"Berikan catatan izin",className:"mt-1"})]})}),a.jsxs(y,{children:[a.jsx(v,{asChild:!0,children:a.jsx(p,{variant:"outline",children:"Batalkan"})}),a.jsx(v,{asChild:!0,children:a.jsx(p,{onClick:()=>{s.post(route("dashboard.presensi.izin",i.id),{...i,kehadiran:"Izin"})},children:"Lanjutkan"})})]})]})]}):null]})})},Q=[{id:"no",header:"No",cell:({row:e})=>e.original.no},{id:"photo_profile",accessorKey:"user.photo_profile_url",header:"Foto Profil",cell:({row:e})=>a.jsx("img",{className:"h-[150px] w-[100px] object-cover aspect-3/4",src:e.original.user.photo_profile_url,alt:"Foto Profil"})},{id:"name",accessorKey:"user.name",header:"Nama"},{id:"nim",accessorKey:"user.nim",header:"NIM"},{id:"status",accessorKey:"user.status",header:"Status"},{id:"ket_status",accessorKey:"user.ket_izin",header:"Keterangan Izin"},{id:"nama_kelompok",accessorKey:"user.nama_kelompok",header:"Kelompok"},{id:"pita",accessorKey:"user.penyakit.pita",header:"Warna Pita"},{id:"ket_penyakit",accessorKey:"user.penyakit.ket_penyakit",header:"Riwayat Penyakit",cell:({row:e})=>a.jsx("p",{children:e.original.user.penyakit.ket_penyakit})},{id:"tanggal_presensi",accessorKey:"user.tanggal_presensi",header:"Waktu Presensi",cell:({row:e})=>a.jsx("p",{children:e.original.user.tanggal_presensi})},{id:"actions",header:"Aksi",cell:({row:e})=>a.jsx(J,{data:e.original})}],$=({day:e})=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-start justify-between"}),a.jsx(L,{}),a.jsx(I,{searchKey:"name",columns:Q,apiEndpoint:route("dashboard.presensi.data",{date:e}),title:"Data Absensi Maba",description:"Gunakan sistem informasi ini untuk manajemen kehadiran maba!"})]}),U=[{title:"Dashboard",link:"/dashboard"},{title:"Absensi Maba",link:"/dashboard/absensi-maba"}];function X({auth:e,response:s,eventList:n}){const[l,d]=t.useState(0),[o,c]=t.useState(0),[m,h]=t.useState(0),[j,x]=t.useState(null),p=(()=>{if(!n)return[];const a=Object.entries(n).map((([e,a])=>({key:e,...a})));return 5===e.user.role_id?a.filter((e=>"2025-08-12"===e.tanggal||"2025-08-15"===e.tanggal)):a})(),u=(()=>{if(p.length>0){if(5===e.user.role_id)return p[0].tanggal;{const e=p.find((e=>"pra_pplk_day_0"===e.key));return e?e.tanggal:p[0].tanggal}}return(new Date).toISOString().split("T")[0]})(),[g,f]=t.useState((()=>localStorage.getItem("selectedDay")||u));q(),t.useEffect((()=>{localStorage.setItem("selectedDay",g)}),[g]);const b=async()=>{try{const e=await fetch(route("dashboard.presensi.count",{date:g}));if(!e.ok)throw new Error("Failed to fetch data");const a=await e.json();d(a.response.data.hadir||0),c(a.response.data.tidakHadir||0),h(a.response.data.izin||0),a.response.data.eventInfo&&x(a.response.data.eventInfo)}catch(e){console.error("Error fetching attendance data:",e)}};return t.useEffect((()=>{b()}),[]),t.useEffect((()=>{b()}),[g]),a.jsxs(a.Fragment,{children:[a.jsxs(r,{user:e.user,children:[a.jsx(K,{items:U}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[a.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Absensi Maba"}),j&&a.jsx("div",{className:"text-sm text-muted-foreground mt-2 md:mt-0"})]}),a.jsxs(D,{onValueChange:e=>{f(e);const a=p.find((a=>a.tanggal===e));x(a||null)},value:g,children:[a.jsx(P,{className:"w-full md:w-[250px] font-bold",children:a.jsx(E,{placeholder:"Pilih Hari/Tanggal"})}),a.jsx(F,{children:a.jsxs(B,{children:[a.jsx(H,{children:"Event PPLK"}),p.map((e=>a.jsxs(T,{value:e.tanggal,children:[e.nama," - ",new Date(e.tanggal).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]},e.key)))]})})]}),a.jsxs("div",{className:"lg:grid-cols-4 grid grid-cols-2 gap-4",children:[a.jsxs(S,{children:[a.jsxs(A,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[a.jsx(M,{className:"text-sm font-medium text-green-500",children:"Maba Hadir"}),a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",className:"fill-green-500",viewBox:"0 0 16 16",children:a.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"})})]}),a.jsx(C,{children:a.jsx("div",{className:"text-2xl font-bold",children:l})})]}),a.jsxs(S,{children:[a.jsxs(A,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[a.jsx(M,{className:"text-sm font-medium text-red-600",children:"Maba Tidak Hadir"}),a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",className:"fill-red-600",viewBox:"0 0 16 16",children:a.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})]}),a.jsx(C,{children:a.jsx("div",{className:"text-2xl font-bold",children:o})})]}),a.jsxs(S,{children:[a.jsxs(A,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[a.jsx(M,{className:"text-sm font-medium text-yellow-500",children:"Maba Izin"}),a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",className:"fill-yellow-500",viewBox:"0 0 16 16",children:a.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})]}),a.jsx(C,{children:a.jsx("div",{className:"text-2xl font-bold",children:m})})]})]}),a.jsxs(G,{defaultValue:"tabel-kehadiran",className:"space-y-4",children:[a.jsxs(O,{children:[a.jsx(R,{value:"tabel-kehadiran",children:"Tabel Kehadiran"}),a.jsx(R,{value:"presensi",children:"Presensi"})]}),a.jsx(V,{value:"presensi",children:a.jsx(i,{})}),a.jsx(V,{value:"tabel-kehadiran",children:a.jsx($,{day:g})})]})]}),a.jsx(W,{})]})}export{X as default};
