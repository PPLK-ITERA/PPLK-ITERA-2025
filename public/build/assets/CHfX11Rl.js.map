{"version":3,"file":"CHfX11Rl.js","sources":["../../../resources/js/Components/dashboard/booklet/BookletForm.tsx","../../../resources/js/Components/dashboard/booklet/BookletCellActions.tsx","../../../resources/js/Pages/Dashboard/booklet/Page.tsx"],"sourcesContent":["import { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { FormEvent, useState } from \"react\";\n\nimport { useForm } from \"@inertiajs/react\";\n\nimport { Button } from \"@/Components/ui/button\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Label } from \"@/Components/ui/label\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\ntype Props = {\n    booklet?: Booklet;\n};\n\nfunction BookletForm({ booklet }: Props) {\n    const { toast } = useToast();\n\n    const { data, setData, post, put, processing, errors } =\n        useForm<Booklet>(booklet);\n    const [urlError, setUrlError] = useState<string | null>(null);\n    const [error, setError] = useState<string | null>(null);\n\n    const validateUrl = useDebouncedCallback(async () => {\n        if (\n            !/^https:\\/\\/(www\\.)?\\w+\\.google\\.com\\/.*$/g.test(data.url_booklet)\n        ) {\n            setUrlError(\"link harus dari Google Drive\");\n            return;\n        }\n\n        let id = data.url_booklet.split(\"/\")[5];\n\n        let response = await fetch(\n            `https://www.googleapis.com/drive/v2/files/${id}?key=${import.meta.env.VITE_GOOGLE_API_KEY}`,\n        );\n\n        if (!response.ok) {\n            setUrlError(\"Link drive belum publik, silahkan coba lagi\");\n            return;\n        }\n\n        setUrlError(\"\");\n    }, 200);\n\n    function onSubmit() {\n        toast({\n            title: \"Mohon tunggu sebentar...\",\n            description: \"Sedang mengupload Booklet...\",\n        });\n\n        if (booklet) {\n            put(route(\"dashboard.booklet.update\", booklet.id), {\n                onError: () => {\n                    toast({\n                        title: \"Uh oh! Gagal mengupdate Booklet.\",\n                        description: errors.nama_booklet || errors.url_booklet,\n                    });\n                },\n                onSuccess: () => {\n                    toast({\n                        title: \"Berhasil!\",\n                        description: \"Booklet berhasil diupdate.\",\n                    });\n                },\n            });\n            window.location.reload();\n        } else {\n            post(route(\"dashboard.booklet.store\"), {\n                onError: () => {\n                    toast({\n                        title: \"Uh oh! Gagal mengupload Booklet.\",\n                        description: errors.nama_booklet || errors.url_booklet,\n                    });\n                },\n                onSuccess: () => {\n                    toast({\n                        title: \"Berhasil!\",\n                        description: \"Booklet berhasil diupload.\",\n                    });\n                },\n            });\n            window.location.reload();\n        }\n    }\n\n    return (\n        <>\n            <form\n                aria-describedby=\"form\"\n                className=\"grid gap-4 py-4\"\n                onSubmit={(e: FormEvent) => {\n                    e.preventDefault();\n                    onSubmit();\n                }}\n            >\n                <div className=\"grid items-center grid-cols-4 gap-4\">\n                    <Label htmlFor=\"nama_booklet\" className=\"text-right\">\n                        Nama Booklet\n                    </Label>\n                    <Input\n                        id=\"nama_booklet\"\n                        name=\"nama_booklet\"\n                        required\n                        type=\"text\"\n                        value={data.nama_booklet}\n                        maxLength={500}\n                        className=\"col-span-3\"\n                        onChange={(e) =>\n                            setData(\"nama_booklet\", e.target.value)\n                        }\n                    />\n                </div>\n                <div className=\"grid items-center grid-cols-4 gap-4\">\n                    <Label htmlFor=\"url_booklet\" className=\"text-right\">\n                        Link Google Drive Booklet\n                    </Label>\n                    <Input\n                        id=\"url_booklet\"\n                        name=\"url_booklet\"\n                        required\n                        type=\"text\"\n                        value={data.url_booklet}\n                        maxLength={500}\n                        className=\"col-span-3\"\n                        onChange={(e) => {\n                            setData(\"url_booklet\", e.target.value);\n                            validateUrl();\n                        }}\n                    />\n                </div>\n                <div className=\"place-content-center flex items-center justify-between gap-4 text-right\">\n                    <Button\n                        type=\"button\"\n                        className=\"bg-orange-500\"\n                        size={\"sm\"}\n                        onClick={validateUrl}\n                    >\n                        Refresh Link\n                    </Button>\n                    {!!urlError ? (\n                        <p className=\"text-sm text-red-500\">{urlError}</p>\n                    ) : urlError === \"\" ? (\n                        <p className=\"text-sm text-green-500\">Link valid</p>\n                    ) : null}\n                </div>\n                <div className=\"place-content-center flex items-center justify-between gap-4 mt-4 text-right\">\n                    <Button\n                        size=\"sm\"\n                        type=\"submit\"\n                        className={`w-full`}\n                        disabled={!!urlError || !!error}\n                    >\n                        {booklet ? \"Perbarui\" : \"Tambahkan\"} Booklet\n                    </Button>\n                </div>\n            </form>\n        </>\n    );\n}\n\nexport default BookletForm;\n","\"use client\";\n\nimport { DialogClose } from \"@radix-ui/react-dialog\";\n\nimport { FormEvent, useEffect, useState } from \"react\";\n\nimport { router, useForm } from \"@inertiajs/react\";\n\nimport { IconTrashFilled } from \"@tabler/icons-react\";\n\nimport BookletForm from \"@/Components/dashboard/booklet/BookletForm\";\nimport { Button } from \"@/Components/ui/button\";\nimport {\n    Dialog,\n    DialogContent,\n    DialogHeader,\n    DialogTitle,\n    DialogTrigger,\n} from \"@/Components/ui/dialog\";\nimport { toast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\ninterface BookletActionProps {\n    booklet: Booklet;\n}\n\nexport const BookletCellActions: React.FC<BookletActionProps> = ({\n    booklet,\n}) => {\n    const {\n        data,\n        setData,\n        delete: del,\n        processing,\n        errors,\n    } = useForm<Booklet>(booklet);\n    const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n    const [editDialogOpen, setEditDialogOpen] = useState(false);\n\n    useEffect(() => {\n        if (deleteDialogOpen || editDialogOpen) {\n            setData(booklet);\n        }\n    }, [deleteDialogOpen, editDialogOpen, booklet, setData]);\n\n    function onDelete() {\n        del(route(\"dashboard.booklet.destroy\", booklet.id), {\n            onError: () => {\n                toast({\n                    title: \"Uh oh! Gagal menghapus Booklet.\",\n                    description: errors.nama_booklet || errors.url_booklet,\n                });\n            },\n            onSuccess: () => {\n                toast({\n                    title: \"Berhasil!\",\n                    description: \"Booklet berhasil dihapus.\",\n                });\n            },\n        });\n        window.location.reload();\n    }\n\n    return (\n        <>\n            <div className=\"flex gap-1 p-2\">\n                <Dialog\n                    open={deleteDialogOpen}\n                    onOpenChange={setDeleteDialogOpen}\n                >\n                    <DialogTrigger asChild>\n                        <Button\n                            className=\"bg-red-500\"\n                            onClick={() => setDeleteDialogOpen(true)}\n                        >\n                            <IconTrashFilled size={18} />\n                            <span>Hapus</span>\n                        </Button>\n                    </DialogTrigger>\n                    <DialogContent className=\"sm:max-w-[425px]\">\n                        <DialogHeader>\n                            <DialogTitle>Hapus Booklet</DialogTitle>\n                        </DialogHeader>\n                        <div>\n                            <p>\n                                Apakah anda yakin ingin menghapus booklet{\" \"}\n                                {booklet.nama_booklet}?\n                            </p>\n                            <div className=\"flex justify-end gap-2 mt-4\">\n                                <DialogClose asChild>\n                                    <Button>Batal</Button>\n                                </DialogClose>\n                                <Button\n                                    onClick={onDelete}\n                                    className=\"bg-red-500\"\n                                >\n                                    Hapus\n                                </Button>\n                            </div>\n                        </div>\n                    </DialogContent>\n                </Dialog>\n\n                <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>\n                    <DialogTrigger asChild>\n                        <Button onClick={() => setEditDialogOpen(true)}>\n                            <span>Edit</span>\n                        </Button>\n                    </DialogTrigger>\n                    <DialogContent className=\"sm:max-w-[425px]\">\n                        <DialogHeader>\n                            <DialogTitle>Edit Booklet</DialogTitle>\n                        </DialogHeader>\n                        <BookletForm booklet={booklet} />\n                    </DialogContent>\n                </Dialog>\n            </div>\n        </>\n    );\n};\n","import { ColumnDef } from \"@tanstack/react-table\";\nimport { format } from \"date-fns\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { FormEvent, useEffect, useState } from \"react\";\n\nimport { useForm } from \"@inertiajs/react\";\n\nimport { CalendarIcon } from \"lucide-react\";\n\nimport { IconPlus } from \"@tabler/icons-react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\n\nimport { BookletCellActions } from \"@/Components/dashboard/booklet/BookletCellActions\";\nimport BookletForm from \"@/Components/dashboard/booklet/BookletForm\";\nimport { Breadcrumbs } from \"@/Components/ui/breadcrumbs\";\nimport { Button } from \"@/Components/ui/button\";\nimport { DataTable } from \"@/Components/ui/data-table\";\nimport {\n    Dialog,\n    DialogContent,\n    DialogHeader,\n    DialogTitle,\n    DialogTrigger,\n} from \"@/Components/ui/dialog\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { toast, useToast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\nconst breadcrumbItems = [\n    { title: \"Dashboard\", link: \"/dashboard\" },\n    { title: \"Booklet\", link: \"/dashboard/booklet\" },\n];\n\ninterface BookletDataResponse {\n    no: number;\n    booklet: Booklet;\n}\n\nexport default function Page({ auth, response }) {\n    const columns: ColumnDef<BookletDataResponse>[] = [\n        {\n            id: \"no\",\n            header: \"No\",\n            cell: ({ row }) => row.index + 1,\n        },\n        {\n            id: \"nama_booklet\",\n            accessorKey: \"booklet.nama_booklet\",\n            header: \"Nama\",\n        },\n        {\n            id: \"url_booklet\",\n            accessorKey: \"booklet.url_booklet\",\n            header: \"Link Booklet\",\n        },\n        {\n            id: \"action\",\n            header: \"Aksi\",\n            cell: ({ row }) => (\n                <BookletCellActions booklet={row.original.booklet} />\n            ),\n        },\n    ];\n\n    return (\n        <DashboardLayout user={auth.user}>\n            <Breadcrumbs items={breadcrumbItems} />\n            <h2 className=\"text-3xl font-bold tracking-tight\">Atur Booklet</h2>\n\n            <div className=\"place-content-start flex w-full\">\n                {/* add dialog */}\n                <Dialog>\n                    <DialogTrigger asChild>\n                        <Button>\n                            <IconPlus size={18} />\n                            <span>Tambah Booklet</span>\n                        </Button>\n                    </DialogTrigger>\n                    <DialogContent>\n                        <DialogHeader>\n                            <DialogTitle>Tambah Booklet</DialogTitle>\n                        </DialogHeader>\n                        <BookletForm />\n                    </DialogContent>\n                </Dialog>\n            </div>\n\n            <DataTable\n                searchKey=\"name\"\n                columns={columns}\n                apiEndpoint={route(\"dashboard.booklet.data\")}\n                title={\"Data Booklet\"}\n                description={\"Data Booklet yang telah diupload.\"}\n            />\n            <Toaster />\n        </DashboardLayout>\n    );\n}\n"],"names":["BookletForm","booklet","toast","useToast","data","setData","post","put","processing","errors","useForm","urlError","setUrlError","useState","error","setError","validateUrl","useDebouncedCallback","async","test","url_booklet","id","split","fetch","ok","Fragment","children","jsxRuntimeExports","jsxs","className","onSubmit","e","preventDefault","title","description","route","onError","nama_booklet","onSuccess","window","location","reload","jsx","Label","htmlFor","Input","name","required","type","value","maxLength","onChange","target","Button","size","onClick","disabled","BookletCellActions","delete","del","deleteDialogOpen","setDeleteDialogOpen","editDialogOpen","setEditDialogOpen","useEffect","Dialog","open","onOpenChange","DialogTrigger","asChild","IconTrashFilled","DialogContent","DialogHeader","DialogTitle","DialogClose","breadcrumbItems","link","Page","auth","response","columns","header","cell","row","index","accessorKey","original","DashboardLayout","user","Breadcrumbs","items","IconPlus","DataTable","searchKey","apiEndpoint","Toaster"],"mappings":"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"}