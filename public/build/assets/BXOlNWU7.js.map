{"version":3,"file":"BXOlNWU7.js","sources":["../../../resources/js/Pages/Mading/Pengumpulan/Page.tsx"],"sourcesContent":["import { set } from \"date-fns\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { Link, router, useForm } from \"@inertiajs/react\";\n\nimport { ChevronLeft } from \"lucide-react\";\n\nimport DefaultLayout from \"@/Layouts/DefaultLayout\";\n\nimport MaxWidthWrapper from \"@/Components/MaxWidthWrapper\";\nimport { Button, buttonVariants } from \"@/Components/ui/button\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Label } from \"@/Components/ui/label\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { CardType } from \"@/lib/types/Mading\";\n\nexport default function Page({ id }) {\n    const [tugasData, setTugasData] = useState<CardType | null>(null);\n    const [urlError, setUrlError] = useState<string | null>(null);\n    const [csrfToken, setCsrfToken] = useState(\"\");\n    const [tugasId, setTugasId] = useState(0);\n    const [isSubmitted, setIsSubmitted] = useState(false);\n\n    const { toast } = useToast();\n\n    const {\n        data: formData,\n        setData: setFormData,\n        post,\n        put,\n        processing,\n        errors,\n    } = useForm({\n        tugas_id: 0,\n        url: \"\",\n    });\n\n    const getTugasData = async () => {\n        try {\n            const response = await fetch(route(\"mading.tugas\", { id }), {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n            });\n\n            if (!response.ok) {\n                throw new Error(\"HTTP status \" + response.status);\n            }\n\n            const data = await response.json();\n            setTugasData(data.tugas);\n            setIsSubmitted(data.isSubmitted);\n        } catch (error) {\n            toast({\n                title: \"Error\",\n                description: \"Gagal mendapatkan data tugas\",\n                variant: \"destructive\",\n            });\n        }\n    };\n\n    useEffect(() => {\n        getTugasData();\n\n        const fetchCsrfToken = async () => {\n            try {\n                const response = await fetch(route(\"csrf\"));\n                const data = await response.json();\n                setCsrfToken(data.csrfToken);\n            } catch (error) {\n                console.error(\"Error fetching CSRF token:\", error);\n            }\n        };\n\n        fetchCsrfToken();\n    }, []);\n\n    const validateUrl = (id: number) => {\n        switch (id) {\n            case 1:\n                validateTiktokUrl();\n                break;\n            case 2:\n                validateTiktokUrl();\n                break;\n            case 3:\n                validateGDriveUrl();\n                break;\n            case 4:\n                validateInstagramUrl();\n                break;\n            case 5:\n                validateTiktokUrl();\n                break;\n            case 6:\n                validateGDriveUrl();\n                break;\n            default:\n                break;\n        }\n    };\n\n    const validateTiktokUrl = useDebouncedCallback(() => {\n        if (!/^https:\\/\\/(www\\.)?tiktok\\.com\\/.*$/g.test(formData.url)) {\n            setUrlError(\"link harus dari TikTok\");\n            return;\n        }\n\n        setUrlError(\"\");\n    }, 200);\n\n    const validateInstagramUrl = useDebouncedCallback(async () => {\n        if (!/^https:\\/\\/(www\\.)?instagram\\.com\\/.*$/g.test(formData.url)) {\n            setUrlError(\"link harus dari Instagram\");\n            return;\n        }\n\n        setUrlError(\"\");\n    }, 200);\n\n    const validateGDriveUrl = useDebouncedCallback(async () => {\n        if (!/^https:\\/\\/(www\\.)?\\w+\\.google\\.com\\/.*$/g.test(formData.url)) {\n            setUrlError(\"link harus dari Google Drive\");\n            return;\n        }\n\n        let id = formData.url.split(\"/\")[5];\n\n        let response = await fetch(\n            `https://www.googleapis.com/drive/v2/files/${id}?key=${import.meta.env.VITE_GOOGLE_API_KEY}`,\n        );\n\n        if (!response.ok) {\n            setUrlError(\"Link drive belum publik, silahkan coba lagi\");\n            return;\n        }\n\n        setUrlError(\"\");\n    }, 200);\n\n    const handleSubmit = async () => {\n        try {\n            const response = await fetch(route(\"mading.store\"), {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"X-CSRF-TOKEN\": csrfToken,\n                },\n                body: JSON.stringify({\n                    tugas_id: tugasId,\n                    jawaban: formData.url,\n                }),\n            });\n\n            if (!response.ok) {\n                throw new Error(\"HTTP status \" + response.status);\n            }\n\n            router.replace(route(\"mading\"));\n        } catch (error) {\n            toast({\n                title: \"Error\",\n                description: \"Gagal mensubmit tugas\",\n                variant: \"destructive\",\n            });\n        }\n    };\n\n    return (\n        <>\n            <DefaultLayout isSolid={true}>\n                <div className=\"bg-pattern-white pt-28\">\n                    <MaxWidthWrapper className=\"min-h-screen\">\n                        <div className=\"px-2.5 bg-white/80 py-5 rounded-md md:px-5 lg:px-10 xl:px-28\">\n                            <Link\n                                href={route(\"mading\")}\n                                className={`${buttonVariants({ variant: \"outline\" })} bg-transparent hover:bg-transparent shadow-none items-center border-none flex gap-2 -ml-5`}\n                            >\n                                <ChevronLeft />\n                                <span>Kembali</span>\n                            </Link>\n                            <h2\n                                data-aos=\"fade-down\"\n                                data-aos-duration=\"1000\"\n                                className=\"font-montserrat font-bold text-jaffa-700 w-fit pt-[30px] text-3xl\"\n                            >\n                                Pengumpulan Tugas Day - {id}\n                            </h2>\n\n                            <div className=\"flex flex-col mt-10\">\n                                {tugasData?.tugas.map((tugas, index) => (\n                                    <div className=\"flex flex-col\" key={index}>\n                                        <Label\n                                            htmlFor=\"input-tugas\"\n                                            className=\"text-left\"\n                                        >\n                                            Link{\" \"}\n                                            {id === \"1\"\n                                                ? \"TikTok\"\n                                                : id === \"2\"\n                                                  ? \"TikTok\"\n                                                  : id === \"3\"\n                                                    ? \"G-Drive\"\n                                                    : id === \"4\"\n                                                      ? \"Instagram\"\n                                                      : id === \"5\"\n                                                        ? \"TikTok\"\n                                                        : \"G-Drive\"}\n                                        </Label>\n\n                                        <Input\n                                            type=\"text\"\n                                            id=\"input-tugas\"\n                                            value={formData.url}\n                                            onChange={(e) => {\n                                                setFormData(\n                                                    \"url\",\n                                                    e.target.value,\n                                                );\n                                                // validateUrl(tugas.id);\n                                                setTugasId(tugas.id);\n                                            }}\n                                            placeholder={\n                                                id === \"1\"\n                                                    ? \"https://www.tiktok.com/...\"\n                                                    : id === \"2\"\n                                                      ? \"https://www.tiktok.com/...\"\n                                                      : id === \"3\"\n                                                        ? \"https://drive.google.com/...\"\n                                                        : id === \"4\"\n                                                          ? \"https://www.instagram.com/...\"\n                                                          : id === \"5\"\n                                                            ? \"https://www.tiktok.com/...\"\n                                                            : \"https://drive.google.com/...\"\n                                            }\n                                            className=\"mt-2\"\n                                        />\n                                        {!!urlError ? (\n                                            <span className=\"text-red-500 text-[12px]\">\n                                                {urlError}\n                                            </span>\n                                        ) : urlError === \"\" ? (\n                                            <span className=\"text-[12px] text-green-500\">\n                                                Link valid\n                                            </span>\n                                        ) : null}\n                                    </div>\n                                ))}\n\n                                {/* bg-candlelight-700 hover:bg-candlelight-700/90 */}\n                                {/* bg-jaffa-700 hover:bg-jaffa-700/90 */}\n\n                                <Button\n                                    onClick={handleSubmit}\n                                    disabled={!!urlError || !formData.url}\n                                    className=\"bg-jaffa-700 hover:bg-jaffa-700/90 w-full mt-5 transition duration-200 ease-in-out\"\n                                >\n                                    Submit Tugas {id}\n                                </Button>\n                            </div>\n                        </div>\n                    </MaxWidthWrapper>\n                </div>\n            </DefaultLayout>\n\n            <Toaster />\n        </>\n    );\n}\n"],"names":["Page","id","tugasData","setTugasData","useState","urlError","setUrlError","csrfToken","setCsrfToken","tugasId","setTugasId","isSubmitted","setIsSubmitted","toast","useToast","data","formData","setData","setFormData","post","put","processing","errors","useForm","tugas_id","url","useEffect","async","response","fetch","route","method","headers","ok","Error","status","json","tugas","error","title","description","variant","console","useDebouncedCallback","test","split","jsxRuntimeExports","jsxs","Fragment","children","jsx","DefaultLayout","isSolid","className","MaxWidthWrapper","Link","href","buttonVariants","ChevronLeft","map","index","Label","htmlFor","Input","type","value","onChange","e","target","placeholder","Button","onClick","body","JSON","stringify","jawaban","yt","replace","disabled","Toaster"],"mappings":"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"}