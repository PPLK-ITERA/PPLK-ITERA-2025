{"version":3,"file":"DOshQRH-.js","sources":["../../../resources/js/Pages/Dashboard/absensi-maba/absensi/Page.tsx"],"sourcesContent":["import QRScanner from \"./QRScanner\";\nimport { IDetectedBarcode, Scanner, outline } from \"@yudiel/react-qr-scanner\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { Link, router, useForm, usePage } from \"@inertiajs/react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\n\nimport { Button, buttonVariants } from \"@/Components/ui/button\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { useFlashToast } from \"@/lib/hooks/useFlashToast\";\n\nfunction Page({ auth }) {\n  const { toast } = useToast();\n\n  const [csrfToken, setCsrfToken] = useState(\"\");\n  const [result, setResult] = useState<string>(\"\");\n  const [error, setError] = useState<string>(\"\");\n  const [loading, setLoading] = useState(false);\n  const { data, setData, post, processing } = useForm({\n    qr_code: \"\",\n  });\n\n  const handleScan = async (data: string) => {\n    if (data) {\n      try {\n        const response = await fetch(route(\"dashboard.presensi.scan\"), {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-CSRF-TOKEN\": csrfToken,\n          },\n          body: JSON.stringify({\n            qr_code: data,\n          }),\n        });\n\n        const getResult = await response.json();\n        //  //console.log(getResult.response);\n\n        if (getResult.response.status === 200) {\n          toast({\n            title: \"Presensi Berhasil\",\n            variant: \"default\",\n            description: getResult.response.message,\n          });\n        } else {\n          toast({\n            title: \"Presensi Gagal\",\n            variant: \"destructive\",\n            description: getResult.response.message,\n          });\n        }\n      } catch (error) {\n        console.error(\"Error:\", error);\n      }\n    }\n  };\n\n  useEffect(() => {\n    // Fungsi untuk mendapatkan token CSRF dari API\n    const fetchCsrfToken = async () => {\n      try {\n        const response = await fetch(route(\"csrf\"));\n        const data = await response.json();\n        setCsrfToken(data.csrfToken);\n      } catch (error) {\n        console.error(\"Error fetching CSRF token:\", error);\n      }\n    };\n\n    fetchCsrfToken();\n  }, []);\n\n  useEffect(() => {\n    if (data.qr_code) {\n      handleScan(data.qr_code);\n    }\n  }, [data.qr_code]);\n\n  return (\n    <>\n      <DashboardLayout user={auth.user}>\n        <div className=\"relative flex flex-col items-center justify-center w-full h-full\">\n          <div className=\"md:w-[100%] w-[75vw] h-[70vh] items-center justify-center\">\n            <h2 className=\"text-xl font-bold tracking-tight text-center\">\n              Absensi QR SCAN Maba\n            </h2>\n\n            {loading ? (\n              <div className=\"border-b-purple-900 flex items-center justify-center w-full h-full\">\n                LOADING\n              </div>\n            ) : (\n              <div className=\"flex items-center justify-center w-full\">\n                <div className=\"md:w-64\">\n                  <Scanner\n                    onScan={function (detectedCodes: IDetectedBarcode[]): void {\n                      //  //console.log(detectedCodes.at(-1)?.rawValue);\n                      handleScan(detectedCodes.at(-1)?.rawValue || \"\");\n                      //  //console.log(detectedCodes);\n                    }}\n                    components={{\n                      finder: true,\n                      tracker: outline,\n                      zoom: true,\n                    }}\n                    allowMultiple={true}\n                    scanDelay={2000}\n                    paused={loading}\n                    styles={{\n                      container: {\n                        width: \"100%\",\n                      },\n                    }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n          <Link href={\"/dashboard/absensi-maba\"} className={buttonVariants()}>\n            Absen Manual\n          </Link>\n          {result && (\n            <p className=\"md:block hidden\">Scanned Result: {result}</p>\n          )}\n        </div>\n      </DashboardLayout>\n      <Toaster />\n    </>\n  );\n}\n\nexport default Page;\n"],"names":["Page","auth","toast","useToast","csrfToken","setCsrfToken","useState","result","setResult","loading","setLoading","data","setData","post","processing","useForm","qr_code","handleScan","async","response","fetch","route","method","headers","body","JSON","stringify","getResult","json","status","title","variant","description","message","error","console","useEffect","jsxRuntimeExports","jsxs","Fragment","children","jsx","DashboardLayout","user","className","Scanner","onScan","detectedCodes","_a","at","rawValue","components","finder","tracker","outline","zoom","allowMultiple","scanDelay","paused","styles","container","width","Link","href","buttonVariants","Toaster"],"mappings":"gfAeA,SAASA,GAAKC,KAAEA,IACR,MAAAC,MAAEA,GAAUC,KAEXC,EAAWC,GAAgBC,WAAS,KACpCC,EAAQC,GAAaF,WAAiB,IACnBA,EAAAA,SAAiB,IAC3C,MAAOG,EAASC,GAAcJ,YAAS,IACjCK,KAAEA,EAAMC,QAAAA,EAAAC,KAASA,EAAMC,WAAAA,GAAeC,EAAQ,CAClDC,QAAS,KAGLC,EAAaC,MAAOP,IACxB,GAAIA,EACE,IACF,MAAMQ,QAAiBC,MAAMC,MAAM,2BAA4B,CAC7DC,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,eAAgBnB,GAElBoB,KAAMC,KAAKC,UAAU,CACnBV,QAASL,MAIPgB,QAAkBR,EAASS,OAGC,MAA9BD,EAAUR,SAASU,OACf3B,EAAA,CACJ4B,MAAO,oBACPC,QAAS,UACTC,YAAaL,EAAUR,SAASc,UAG5B/B,EAAA,CACJ4B,MAAO,iBACPC,QAAS,cACTC,YAAaL,EAAUR,SAASc,gBAG7BC,GACCC,QAAAD,MAAM,SAAUA,EAC1B,CACF,EAwBF,OArBAE,EAAAA,WAAU,KAEelB,WACjB,IACF,MAAMC,QAAiBC,MAAMC,MAAM,SAC7BV,QAAaQ,EAASS,OAC5BvB,EAAaM,EAAKP,iBACX8B,GACCC,QAAAD,MAAM,6BAA8BA,EAC9C,QAID,IAEHE,EAAAA,WAAU,KACJzB,EAAKK,SACPC,EAAWN,EAAKK,QAClB,GACC,CAACL,EAAKK,UAILqB,EAAAC,KAAAC,WAAA,CAAAC,SAAA,CAAAC,EAAAA,IAACC,GAAgBC,KAAM1C,EAAK0C,KAC1BH,SAACF,EAAAA,KAAA,MAAA,CAAIM,UAAU,mEACbJ,SAAA,GAACF,KAAA,MAAA,CAAIM,UAAU,4DACbJ,SAAA,CAACC,EAAAA,IAAA,KAAA,CAAGG,UAAU,+CAA+CJ,SAE7D,yBAEC/B,EACCgC,EAAAA,IAAC,MAAI,CAAAG,UAAU,qEAAqEJ,SAEpF,YAECC,EAAAA,IAAA,MAAA,CAAIG,UAAU,0CACbJ,SAACC,EAAAA,IAAA,MAAA,CAAIG,UAAU,UACbJ,SAAAH,EAAAI,IAACI,EAAA,CACCC,OAAQ,SAAUC,SAEhB9B,GAAW,OAAA+B,IAAcC,IAAG,SAAjB,EAAAD,EAAsBE,WAAY,GAE/C,EACAC,WAAY,CACVC,QAAQ,EACRC,QAASC,EACTC,MAAM,GAERC,eAAe,EACfC,UAAW,IACXC,OAAQjD,EACRkD,OAAQ,CACNC,UAAW,CACTC,MAAO,wBAQpBC,EAAK,CAAAC,KAAM,0BAA2BnB,UAAWoB,IAAkBxB,SAEpE,iBACCjC,GACC8B,EAAAC,KAAC,IAAE,CAAAM,UAAU,kBAAkBJ,SAAA,CAAA,mBAAiBjC,gBAIrD0D,EAAQ,MAGf"}