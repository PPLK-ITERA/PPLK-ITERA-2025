import{r as a,j as s,A as e}from"./Cuadvpgc.js";import{D as l}from"./Dd8RjkLT.js";import{B as r}from"./pZO4vjTv.js";import{B as t}from"./CS0zgTV8.js";import{C as n,b as i,c as d,a as c}from"./DTVEQivs.js";import{T as m,b as o,c as h,a as x}from"./KHERY7jd.js";import{T as j}from"./BrhaNaLC.js";import"./BbWRkWWZ.js";import"./yEihEaud.js";import"./OhYcO60T.js";import"./BATGzmgJ.js";import"./J5x9RQPa.js";import"./BMbQ6VS6.js";import"./CiwqXEnr.js";import"./Bi7HUfK4.js";import"./CbL-ctTR.js";import"./CdKkzVoY.js";import"./ChplkwN5.js";import"./BPWbQ1xy.js";const u=[{title:"Ellysion Panel",link:"/dashboard"},{title:"Komdis",link:"/dashboard/komdis"}];function p({auth:p,logs:g,userData:b,redirectToInput:k}){const[N,v]=a.useState(k?"input":"list"),[f,y]=a.useState(b||null),[S,w]=a.useState("");return s.jsxs(l,{user:p.user,children:[s.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4",children:"Log Komdis"}),s.jsx(r,{items:u}),s.jsxs(m,{defaultValue:"list",value:N,onValueChange:v,className:"mt-4",children:[s.jsxs(o,{children:[s.jsx(h,{value:"list",children:"Daftar Pelanggaran"}),s.jsx(h,{value:"scan",children:"Scan QR"}),f&&s.jsx(h,{value:"input",children:"Isi Kesalahan"})]}),s.jsx(x,{value:"list",children:s.jsxs(n,{className:"mt-4",children:[s.jsx(i,{children:s.jsx(d,{children:"Data Pelanggaran"})}),s.jsx(c,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left border-b",children:[s.jsx("th",{className:"p-2",children:"Nama"}),s.jsx("th",{className:"p-2",children:"NIM"}),s.jsx("th",{className:"p-2",children:"Kesalahan"}),s.jsx("th",{className:"p-2",children:"Status"}),s.jsx("th",{className:"p-2",children:"Tanggal"}),s.jsx("th",{className:"p-2",children:"Aksi"})]})}),s.jsx("tbody",{children:g.map((a=>s.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[s.jsx("td",{className:"p-2",children:a.user?.name}),s.jsx("td",{className:"p-2",children:a.user?.nim}),s.jsx("td",{className:"p-2",children:a.kesalahan}),s.jsx("td",{className:"p-2",children:s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("selesai"===a.status?"bg-green-100 text-green-800":"proses"===a.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:a.status||"belum diproses"})}),s.jsx("td",{className:"p-2",children:new Date(a.created_at).toLocaleDateString("id-ID")}),s.jsx("td",{className:"p-2",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(t,{size:"sm",onClick:()=>{return s=a.id,void e.get(route("dashboard.komdis.edit",s));var s},className:"bg-gray-900 hover:bg-gray-800 text-white border-0 px-3 py-1.5 rounded-md",children:"Edit"}),s.jsx(t,{size:"sm",onClick:()=>{return s=a.id,void(confirm("Yakin ingin menghapus data komdis ini?")&&e.delete(route("dashboard.komdis.destroy",s),{onSuccess:()=>{window.location.reload()},onError:a=>{alert("Gagal menghapus data")}}));var s},className:"bg-red-500 hover:bg-red-600 text-white border-0 px-3 py-1.5 rounded-md",children:"Delete"})]})})]},a.id)))})]})})})]})}),s.jsx(x,{value:"scan",children:s.jsx("div",{className:"space-y-4",children:s.jsxs(n,{className:"mt-4",children:[s.jsx(i,{children:s.jsx(d,{children:"Scan QR Code dengan Kamera"})}),s.jsxs(c,{className:"text-center",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"Klik tombol di bawah untuk membuka halaman QR scanner"}),s.jsx(t,{onClick:()=>e.get(route("dashboard.komdis.scanner")),className:"w-full",size:"lg",children:"ðŸ“· Buka QR Scanner"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-4 space-y-1",children:[s.jsx("p",{children:"â€¢ Scanner akan membuka halaman terpisah"}),s.jsx("p",{children:"â€¢ Arahkan kamera ke QR code mahasiswa"}),s.jsx("p",{children:"â€¢ Hasil scan otomatis akan kembali ke halaman ini"})]})]})]})})}),s.jsx(x,{value:"input",children:s.jsxs(n,{className:"mt-4",children:[s.jsx(i,{children:s.jsxs(d,{children:["Isi Kesalahan untuk ",f?.name||f?.nama," (",f?.nim,")"]})}),s.jsx(c,{children:s.jsxs("form",{onSubmit:a=>{a.preventDefault(),e.post("/dashboard/komdis/store",{user_id:f.id,kesalahan:S},{onSuccess:()=>{w(""),y(null),v("list")},onError:a=>{console.error("Submit errors:",a),alert(a.kesalahan||"Terjadi kesalahan")}})},className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kesalahan/Pelanggaran:"}),s.jsx(j,{placeholder:"Masukkan detail kesalahan atau pelanggaran yang dilakukan",value:S,onChange:a=>w(a.target.value),required:!0,rows:4})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(t,{type:"submit",disabled:!S.trim(),children:"Simpan Data"}),s.jsx(t,{type:"button",variant:"outline",onClick:()=>{y(null),w(""),v("scan")},children:"Batal"})]})]})})]})})]})]})}export{p as default};
