import{r as e,G as s,j as t,x as r,A as a}from"./BJ63vrvw.js";import{J as i,Q as o}from"./Dg1JWLN4.js";import{D as n}from"./BPICyXNI.js";import{b as c}from"./CsmS4u-l.js";import{T as d}from"./BPGHkhlH.js";import{u as m}from"./t430rQfd.js";import{u as l}from"./Bw1MgyBe.js";import"./DKPdzo17.js";import"./Br3FPSWO.js";import"./CU22SqzI.js";import"./FuNdJX5X.js";import"./Ct_MZYFB.js";import"./DR0cPz1Y.js";import"./DAVIlz_J.js";import"./jpp9-Dbs.js";import"./CwPVjjER.js";import"./BdWndB40.js";import"./C0u18CNn.js";import"./Crdu50mv.js";function u({auth:u}){const{toast:j}=m(),[f,p]=e.useState(""),[h,x]=e.useState(""),[w,v]=e.useState(""),[y,b]=e.useState(!1);s({qr_code:""});return e.useEffect((()=>{(async()=>{try{const e=await fetch(route("csrf")),s=await e.json();p(s.csrfToken)}catch(e){console.error("Error fetching CSRF token:",e)}})()}),[]),l(),t.jsxs(t.Fragment,{children:[t.jsx(n,{user:u.user,children:t.jsxs("div",{className:"relative flex flex-col items-center justify-center w-full h-full",children:[t.jsxs("div",{className:"md:w-[100%] w-[75vw] h-[70vh] items-center justify-center",children:[t.jsx("h2",{className:"text-xl font-bold tracking-tight text-center mb-4",children:"QR Scanner - Log Komdis"}),y?t.jsx("div",{className:"border-b-purple-900 flex items-center justify-center w-full h-full",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-2"}),t.jsx("p",{children:"Memproses QR Code..."})]})}):t.jsx("div",{className:"flex items-center justify-center w-full",children:t.jsx("div",{className:"md:w-64",children:t.jsx(i,{onScan:function(e){const s=e.at(-1)?.rawValue;s&&((async e=>{if(e){b(!0);try{const s=await fetch(`/dashboard/komdis/create?qr_code=${encodeURIComponent(e)}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f}}),t=await s.json();t.success?(j({title:"Mahasiswa Ditemukan",variant:"default",description:`${t.data.name} - ${t.data.nim}`}),setTimeout((()=>{a.get(route("dashboard.komdis.index"),{userData:JSON.stringify(t.data),redirectToInput:!0})}),1500)):j({title:"Mahasiswa Tidak Ditemukan",variant:"destructive",description:t.message||"QR Code tidak terdaftar dalam sistem"})}catch(s){console.error("Error:",s),j({title:"Error",variant:"destructive",description:"Terjadi kesalahan saat memproses QR code"})}b(!1)}})(s),x(s))},components:{finder:!0,tracker:o,zoom:!0},allowMultiple:!0,scanDelay:2e3,paused:y,styles:{container:{width:"100%"}}})})})]}),t.jsxs("div",{className:"flex flex-col items-center gap-3 mt-4",children:[t.jsx(r,{href:route("dashboard.komdis.index"),className:c(),children:"Input Manual"}),h&&t.jsxs("p",{className:"md:block hidden text-sm text-gray-600",children:["Last Scanned: ",h.substring(0,50),h.length>50?"...":""]})]})]})}),t.jsx(d,{})]})}export{u as default};
