import{r as t,W as a,j as s,a as e,y as i}from"./DpJP6SCO.js";import{c as r}from"./BRd7m4bF.js";import{D as n}from"./BeUs2jWE.js";import{M as o}from"./DDh_BBcJ.js";import{b as l,B as c}from"./D5GspPXq.js";import{I as p}from"./Bk3QRDmu.js";import{L as m}from"./3VJvGHwl.js";import{T as d}from"./Daao7sDT.js";import{u}from"./BexPmjt8.js";import{C as g}from"./DMPqpYmi.js";import"./mhnRNCZ2.js";import"./C46PLoNX.js";import"./BZtDV8eV.js";import"./5YIZTBGQ.js";import"./D8N-AUd4.js";import"./Cb5bVkFK.js";import"./CgcE0uHS.js";import"./wezJyQcX.js";import"./1olcKE-l.js";import"./DvUEoUiA.js";import"./Cy-CtYnj.js";function h({id:h}){const[j,w]=t.useState(null),[f,x]=t.useState(new Map),[k,b]=t.useState(""),{toast:v}=u(),{data:y,setData:T,post:N,put:S,processing:C,errors:M}=a({tugas_id:[],jawaban:[]}),E=(t,a)=>{const s=[...y.jawaban];s[t]=a,T("jawaban",s)};t.useEffect((()=>{(async()=>{try{const t=await fetch(route("mading.tugas",{id:h}),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("HTTP status "+t.status);const a=await t.json();w(a);let s=[];a.tugas.forEach(((t,a)=>{s.push(t.id),E(a,"")})),T("tugas_id",s)}catch(t){v({title:"Error",description:"Gagal mendapatkan data tugas",variant:"destructive"})}})();(async()=>{try{const t=await fetch(route("csrf")),a=await t.json();b(a.csrfToken)}catch(t){console.error("Error fetching CSRF token:",t)}})()}),[]);const _=r(((t,a,s)=>{/^https:\/\/(www\.)?tiktok\.com\/.*$/g.test(a)?(x(new Map(f).set(t,"")),E(s,a)):x(new Map(f).set(t,"link harus dari TikTok"))}),200),G=r((async(t,a,s)=>{/^https:\/\/(www\.)?instagram\.com\/.*$/g.test(a)?(x(new Map(f).set(t,"")),E(s,a)):x(new Map(f).set(t,"link harus dari Instagram"))}),200),$=r((async(t,a,s)=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(a))return void x(new Map(f).set(t,"link harus dari Google Drive"));let e=a.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${e}?key=AIzaSyB4-JCqVpt3dC5MlC0Q6yQOSYG0uysdvwc`)).ok?(x(new Map(f).set(t,"")),E(s,a)):x(new Map(f).set(t,"Link drive belum publik, silahkan coba lagi"))}),200);return s.jsxs(s.Fragment,{children:[s.jsx(n,{isSolid:!0,children:s.jsx("div",{className:"bg-pattern-white pt-28",children:s.jsx(o,{className:"min-h-screen",children:s.jsxs("div",{className:"px-2.5 bg-white/80 py-5 rounded-md md:px-5 lg:px-10 xl:px-28",children:[s.jsxs(e,{href:route("mading"),className:`${l({variant:"outline"})} bg-transparent hover:bg-transparent shadow-none items-center border-none flex gap-2 -ml-5`,children:[s.jsx(g,{}),s.jsx("span",{children:"Kembali"})]}),s.jsxs("h2",{"data-aos":"fade-down","data-aos-duration":"1000",className:"font-montserrat font-bold text-jaffa-700 w-fit pt-[30px] text-3xl",children:["Pengumpulan Tugas Day - ",h]}),s.jsxs("div",{className:"flex flex-col mt-10",children:[null==j?void 0:j.tugas.map(((t,a)=>s.jsxs("div",{className:"flex flex-col",children:[s.jsxs(m,{htmlFor:"input-tugas",className:"text-left capitalize",children:["Link ",t.tipe_link]}),s.jsx(p,{type:"text",id:"input-tugas",onChange:s=>{((t,a,s,e)=>{switch(t){case"tiktok":_(a,s,e);break;case"instagram":G(a,s,e);break;case"drive":$(a,s,e)}})(t.tipe_link,t.id,s.target.value,a)},placeholder:"tiktok"===t.tipe_link?"https://www.tiktok.com/...":"instagram"===t.tipe_link?"https://www.instagram.com/...":"drive"===t.tipe_link?"https://drive.google.com/...":"Yeuu gaada kocakkkkk!",className:"mt-2"}),f.get(t.id)?s.jsx("span",{className:"text-red-500 text-[12px]",children:f.get(t.id)}):""===f.get(t.id)?s.jsx("span",{className:"text-[12px] text-green-500",children:"Link valid"}):null]},a))),s.jsxs(c,{onClick:async()=>{try{const t=await fetch(route("mading.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":k},body:JSON.stringify({tugas_id:y.tugas_id,jawaban:y.jawaban})});if(!t.ok)throw new Error("HTTP status "+t.status);i.replace(route("mading"))}catch(t){v({title:"Error",description:"Gagal mensubmit tugas",variant:"destructive"})}},disabled:!(()=>{for(const[t,a]of f.entries())if(""!==a)return!1;return!0})()||!y.jawaban.length,className:"bg-jaffa-700 hover:bg-jaffa-700/90 w-full mt-5 transition duration-200 ease-in-out",children:["Submit Tugas ",h]})]})]})})})}),s.jsx(d,{})]})}export{h as default};
