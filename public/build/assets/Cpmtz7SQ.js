import{r as s,j as a,S as e,A as l}from"./BjspqHFC.js";import{D as r}from"./BgVBjpmr.js";import{B as t}from"./CvfnwBdU.js";import{B as i}from"./DriYKr9S.js";import{C as n,b as d,c,a as m}from"./C9yiQ1k_.js";import{T as o,b as h,c as x,a as j}from"./BWPjJBhh.js";import{T as u}from"./op-Sp9Nn.js";import"./Ds1sWlmM.js";import"./CXnlhd6X.js";import"./Dd8dNriH.js";import"./BVpFNSL6.js";import"./CVuMtgWZ.js";import"./EVeFWGYJ.js";import"./B6xL83kG.js";import"./Dogk9wFg.js";import"./CwYCMz04.js";import"./Bnk1J1Ax.js";import"./C0u18CNn.js";import"./C90B4T_L.js";const p=[{title:"Ellysion Panel",link:"/dashboard"},{title:"Komdis",link:"/dashboard/komdis"}];function g({auth:g,logs:b,userData:k,redirectToInput:N}){const[v,f]=s.useState(N?"input":"list"),[y,S]=s.useState(k||null),[w,D]=s.useState("");return a.jsxs(a.Fragment,{children:[a.jsx(e,{title:"Log Komdis"}),a.jsxs(r,{user:g.user,children:[a.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4",children:"Log Komdis"}),a.jsx(t,{items:p}),a.jsxs(o,{defaultValue:"list",value:v,onValueChange:f,className:"mt-4",children:[a.jsxs(h,{children:[a.jsx(x,{value:"list",children:"Daftar Pelanggaran"}),a.jsx(x,{value:"scan",children:"Scan QR"}),y&&a.jsx(x,{value:"input",children:"Isi Kesalahan"})]}),a.jsx(j,{value:"list",children:a.jsxs(n,{className:"mt-4",children:[a.jsx(d,{children:a.jsx(c,{children:"Data Pelanggaran"})}),a.jsx(m,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left border-b",children:[a.jsx("th",{className:"p-2",children:"Nama"}),a.jsx("th",{className:"p-2",children:"NIM"}),a.jsx("th",{className:"p-2",children:"Kesalahan"}),a.jsx("th",{className:"p-2",children:"Status"}),a.jsx("th",{className:"p-2",children:"Tanggal"}),a.jsx("th",{className:"p-2",children:"Aksi"})]})}),a.jsx("tbody",{children:b.map((s=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-2",children:s.user?.name}),a.jsx("td",{className:"p-2",children:s.user?.nim}),a.jsx("td",{className:"p-2",children:s.kesalahan}),a.jsx("td",{className:"p-2",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("selesai"===s.status?"bg-green-100 text-green-800":"proses"===s.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:s.status||"belum diproses"})}),a.jsx("td",{className:"p-2",children:new Date(s.created_at).toLocaleDateString("id-ID")}),a.jsx("td",{className:"p-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(i,{size:"sm",onClick:()=>{return a=s.id,void l.get(route("dashboard.komdis.edit",a));var a},className:"bg-gray-900 hover:bg-gray-800 text-white border-0 px-3 py-1.5 rounded-md",children:"Edit"}),a.jsx(i,{size:"sm",onClick:()=>{return a=s.id,void(confirm("Yakin ingin menghapus data komdis ini?")&&l.delete(route("dashboard.komdis.destroy",a),{onSuccess:()=>{window.location.reload()},onError:s=>{alert("Gagal menghapus data")}}));var a},className:"bg-red-500 hover:bg-red-600 text-white border-0 px-3 py-1.5 rounded-md",children:"Delete"})]})})]},s.id)))})]})})})]})}),a.jsx(j,{value:"scan",children:a.jsx("div",{className:"space-y-4",children:a.jsxs(n,{className:"mt-4",children:[a.jsx(d,{children:a.jsx(c,{children:"Scan QR Code dengan Kamera"})}),a.jsxs(m,{className:"text-center",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"Klik tombol di bawah untuk membuka halaman QR scanner"}),a.jsx(i,{onClick:()=>l.get(route("dashboard.komdis.scanner")),className:"w-full",size:"lg",children:"ðŸ“· Buka QR Scanner"}),a.jsxs("div",{className:"text-xs text-gray-500 mt-4 space-y-1",children:[a.jsx("p",{children:"â€¢ Scanner akan membuka halaman terpisah"}),a.jsx("p",{children:"â€¢ Arahkan kamera ke QR code mahasiswa"}),a.jsx("p",{children:"â€¢ Hasil scan otomatis akan kembali ke halaman ini"})]})]})]})})}),a.jsx(j,{value:"input",children:a.jsxs(n,{className:"mt-4",children:[a.jsx(d,{children:a.jsxs(c,{children:["Isi Kesalahan untuk ",y?.name||y?.nama," (",y?.nim,")"]})}),a.jsx(m,{children:a.jsxs("form",{onSubmit:s=>{s.preventDefault(),l.post("/dashboard/komdis/store",{user_id:y.id,kesalahan:w},{onSuccess:()=>{D(""),S(null),f("list")},onError:s=>{console.error("Submit errors:",s),alert(s.kesalahan||"Terjadi kesalahan")}})},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kesalahan/Pelanggaran:"}),a.jsx(u,{placeholder:"Masukkan detail kesalahan atau pelanggaran yang dilakukan",value:w,onChange:s=>D(s.target.value),required:!0,rows:4})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(i,{type:"submit",disabled:!w.trim(),children:"Simpan Data"}),a.jsx(i,{type:"button",variant:"outline",onClick:()=>{S(null),D(""),f("scan")},children:"Batal"})]})]})})]})})]})]})]})}export{g as default};
