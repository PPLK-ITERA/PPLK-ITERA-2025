import{W as e,r as s,j as o}from"./Bn9ZB4In.js";import{D as t}from"./U86jyzg0.js";import{D as a}from"./CgL7Faz3.js";import{c as l}from"./WBiqt6TG.js";import{B as r}from"./BhP6A7-3.js";import{I as i}from"./DGsWg_ya.js";import{L as n}from"./Bc7mUC1l.js";import{u as d,t as c}from"./B_92FyG_.js";import{D as m,f as h,a as p,b as j,c as x}from"./Cg3mTt2p.js";import{I as u}from"./DI7G1wZr.js";import{B as k}from"./BCUoiaoS.js";import{D as b}from"./DNdxwxjl.js";import{T as g}from"./Ct0xQGWr.js";import{I as f}from"./DhxGIQOW.js";import"./BSAxLKsk.js";import"./CBVuIHIj.js";import"./BxDPZtBj.js";import"./BvDxZe5W.js";import"./BELJS3jY.js";import"./qz5uz89B.js";import"./BKpOc1Zl.js";import"./DS-qx-uy.js";import"./DgNwS5Up.js";import"./BWAKTBD8.js";import"./DjK13lC_.js";import"./DyKupxJf.js";import"./BaD9fAq3.js";import"./CgSkoW6E.js";var _={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_NAME:""};function B({booklet:t}){const{toast:a}=d(),{data:c,setData:m,post:h,put:p,processing:j,errors:x}=e(t),[u,k]=s.useState(null),[b,g]=s.useState(null),f=l((async()=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(c.url_booklet))return void k("link harus dari Google Drive");let e=c.url_booklet.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${e}?key=${_.VITE_GOOGLE_API_KEY}`)).ok?k(""):k("Link drive belum publik, silahkan coba lagi")}),200);return o.jsx(o.Fragment,{children:o.jsxs("form",{"aria-describedby":"form",className:"grid gap-4 py-4",onSubmit:e=>{e.preventDefault(),a({title:"Mohon tunggu sebentar...",description:"Sedang mengupload Booklet..."}),t?(p(route("dashboard.booklet.update",t.id),{onError:()=>{a({title:"Uh oh! Gagal mengupdate Booklet.",description:x.nama_booklet||x.url_booklet})},onSuccess:()=>{a({title:"Berhasil!",description:"Booklet berhasil diupdate."})}}),window.location.reload()):(h(route("dashboard.booklet.store"),{onError:()=>{a({title:"Uh oh! Gagal mengupload Booklet.",description:x.nama_booklet||x.url_booklet})},onSuccess:()=>{a({title:"Berhasil!",description:"Booklet berhasil diupload."})}}),window.location.reload())},children:[o.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[o.jsx(n,{htmlFor:"nama_booklet",className:"text-right",children:"Nama Booklet"}),o.jsx(i,{id:"nama_booklet",name:"nama_booklet",required:!0,type:"text",value:c.nama_booklet,maxLength:500,className:"col-span-3",onChange:e=>m("nama_booklet",e.target.value)})]}),o.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[o.jsx(n,{htmlFor:"url_booklet",className:"text-right",children:"Link Google Drive Booklet"}),o.jsx(i,{id:"url_booklet",name:"url_booklet",required:!0,type:"text",value:c.url_booklet,maxLength:500,className:"col-span-3",onChange:e=>{m("url_booklet",e.target.value),f()}})]}),o.jsxs("div",{className:"place-content-center flex items-center justify-between gap-4 text-right",children:[o.jsx(r,{type:"button",className:"bg-orange-500",size:"sm",onClick:f,children:"Refresh Link"}),u?o.jsx("p",{className:"text-sm text-red-500",children:u}):""===u?o.jsx("p",{className:"text-sm text-green-500",children:"Link valid"}):null]}),o.jsx("div",{className:"place-content-center flex items-center justify-between gap-4 mt-4 text-right",children:o.jsxs(r,{size:"sm",type:"submit",className:"w-full",disabled:!!u||!!b,children:[t?"Perbarui":"Tambahkan"," Booklet"]})})]})})}const N=({booklet:t})=>{const{data:l,setData:i,delete:n,processing:d,errors:k}=e(t),[b,g]=s.useState(!1),[f,_]=s.useState(!1);return s.useEffect((()=>{(b||f)&&i(t)}),[b,f,t,i]),o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex gap-1 p-2",children:[o.jsxs(m,{open:b,onOpenChange:g,children:[o.jsx(h,{asChild:!0,children:o.jsxs(r,{className:"bg-red-500",onClick:()=>g(!0),children:[o.jsx(u,{size:18}),o.jsx("span",{children:"Hapus"})]})}),o.jsxs(p,{className:"sm:max-w-[425px]",children:[o.jsx(j,{children:o.jsx(x,{children:"Hapus Booklet"})}),o.jsxs("div",{children:[o.jsxs("p",{children:["Apakah anda yakin ingin menghapus booklet ",t.nama_booklet,"?"]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(a,{asChild:!0,children:o.jsx(r,{children:"Batal"})}),o.jsx(r,{onClick:function(){n(route("dashboard.booklet.destroy",t.id),{onError:()=>{c({title:"Uh oh! Gagal menghapus Booklet.",description:k.nama_booklet||k.url_booklet})},onSuccess:()=>{c({title:"Berhasil!",description:"Booklet berhasil dihapus."})}}),window.location.reload()},className:"bg-red-500",children:"Hapus"})]})]})]})]}),o.jsxs(m,{open:f,onOpenChange:_,children:[o.jsx(h,{asChild:!0,children:o.jsx(r,{onClick:()=>_(!0),children:o.jsx("span",{children:"Edit"})})}),o.jsxs(p,{className:"sm:max-w-[425px]",children:[o.jsx(j,{children:o.jsx(x,{children:"Edit Booklet"})}),o.jsx(B,{booklet:t})]})]})]})})},w=[{title:"Dashboard",link:"/dashboard"},{title:"Booklet",link:"/dashboard/booklet"}];function v({auth:e,response:s}){const a=[{id:"no",header:"No",cell:({row:e})=>e.index+1},{id:"nama_booklet",accessorKey:"booklet.nama_booklet",header:"Nama"},{id:"url_booklet",accessorKey:"booklet.url_booklet",header:"Link Booklet"},{id:"action",header:"Aksi",cell:({row:e})=>o.jsx(N,{booklet:e.original.booklet})}];return o.jsxs(t,{user:e.user,children:[o.jsx(k,{items:w}),o.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Atur Booklet"}),o.jsx("div",{className:"place-content-start flex w-full",children:o.jsxs(m,{children:[o.jsx(h,{asChild:!0,children:o.jsxs(r,{children:[o.jsx(f,{size:18}),o.jsx("span",{children:"Tambah Booklet"})]})}),o.jsxs(p,{children:[o.jsx(j,{children:o.jsx(x,{children:"Tambah Booklet"})}),o.jsx(B,{})]})]})}),o.jsx(b,{searchKey:"name",columns:a,apiEndpoint:route("dashboard.booklet.data"),title:"Data Booklet",description:"Data Booklet yang telah diupload."}),o.jsx(g,{})]})}export{v as default};
