{"version":3,"file":"Eg01IVJL.js","sources":["../../../resources/js/Pages/Mading/Pengumpulan/Page.tsx"],"sourcesContent":["import { set } from \"date-fns\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { Link, router, useForm } from \"@inertiajs/react\";\n\nimport { ChevronLeft } from \"lucide-react\";\n\nimport DefaultLayout from \"@/Layouts/DefaultLayout\";\n\nimport MaxWidthWrapper from \"@/Components/MaxWidthWrapper\";\nimport { Button, buttonVariants } from \"@/Components/ui/button\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Label } from \"@/Components/ui/label\";\n\nimport { CardType } from \"@/lib/types/Mading\";\n\nimport kompas from \"!assets/kompas.png\";\n\nexport default function Page({ id }) {\n    const [tugasData, setTugasData] = useState<CardType | null>(null);\n    const [urlError, setUrlError] = useState<string | null>(null);\n    const [csrfToken, setCsrfToken] = useState(\"\");\n    const [tugasId, setTugasId] = useState(0);\n    const [isSubmitted, setIsSubmitted] = useState(false);\n\n    const {\n        data: formData,\n        setData: setFormData,\n        post,\n        put,\n        processing,\n        errors,\n    } = useForm({\n        tugas_id: 0,\n        url: \"\",\n    });\n\n    const getTugasData = async () => {\n        try {\n            const response = await fetch(route(\"mading.tugas\", { id }), {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n            });\n\n            if (!response.ok) {\n                throw new Error(\"HTTP status \" + response.status);\n            }\n\n            const data = await response.json();\n            setTugasData(data.tugas);\n            setIsSubmitted(data.isSubmitted);\n            console.log(\"tugasData\", tugasData);\n        } catch (error) {\n            console.log(\"Error: \", error);\n        }\n    };\n\n    useEffect(() => {\n        getTugasData();\n\n        const fetchCsrfToken = async () => {\n            try {\n                const response = await fetch(route(\"csrf\"));\n                const data = await response.json();\n                setCsrfToken(data.csrfToken);\n            } catch (error) {\n                console.error(\"Error fetching CSRF token:\", error);\n            }\n        };\n\n        fetchCsrfToken();\n    }, []);\n\n    const validateUrl = useDebouncedCallback(async () => {\n        if (!/^https:\\/\\/(www\\.)?\\w+\\.google\\.com\\/.*$/g.test(formData.url)) {\n            setUrlError(\"link harus dari Google Drive\");\n            return;\n        }\n\n        let id = formData.url.split(\"/\")[5];\n\n        let response = await fetch(\n            `https://www.googleapis.com/drive/v2/files/${id}?key=${import.meta.env.VITE_GOOGLE_API_KEY}`,\n        );\n\n        if (!response.ok) {\n            setUrlError(\"Link drive belum publik, silahkan coba lagi\");\n            return;\n        }\n\n        setUrlError(\"\");\n    }, 100);\n\n    const handleSubmit = async () => {\n        try {\n            const response = await fetch(route(\"mading.store\"), {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"X-CSRF-TOKEN\": csrfToken,\n                },\n                body: JSON.stringify({\n                    tugas_id: tugasId,\n                    jawaban: formData.url,\n                }),\n            });\n\n            if (!response.ok) {\n                throw new Error(\"HTTP status \" + response.status);\n            }\n\n            router.replace(route(\"mading\"));\n        } catch (error) {\n            console.log(\"Error: \", error);\n        }\n    };\n\n    return (\n        <>\n            <DefaultLayout isSolid={true}>\n                <div className=\"bg-pattern-white pt-28\">\n                    <MaxWidthWrapper className=\"min-h-screen\">\n                        <div className=\"px-2.5 bg-white/80 py-5 rounded-md md:px-5 lg:px-10 xl:px-28\">\n                            <Link\n                                href={route(\"mading\")}\n                                className={`${buttonVariants({ variant: \"outline\" })} bg-transparent hover:bg-transparent shadow-none items-center border-none flex gap-2 -ml-5`}\n                            >\n                                <ChevronLeft />\n                                <span>Kembali</span>\n                            </Link>\n                            <h2\n                                data-aos=\"fade-down\"\n                                data-aos-duration=\"1000\"\n                                className=\"font-montserrat font-bold text-jaffa-700 w-fit pt-[30px] text-3xl\"\n                            >\n                                Pengumpulan Tugas Day - {id}\n                            </h2>\n\n                            {/* Day 0 TikTok\n                                    Day 1 TikTok\n                                    Day 2 Drive PDF &\n                                    check Linkedin\n                                    Day 3 Upload IG\n                                    Day 4 Upload TikTok\n                                    Day 5 Upload PDF Drive */}\n\n                            <div className=\"flex flex-col mt-10\">\n                                {tugasData?.tugas.map((tugas, index) => (\n                                    <div className=\"flex flex-col\" key={index}>\n                                        <Label\n                                            htmlFor=\"input-tugas\"\n                                            className=\"text-left\"\n                                        >\n                                            Link{\" \"}\n                                            {id === \"1\"\n                                                ? \"TikTok\"\n                                                : id === \"2\"\n                                                  ? \"TikTok\"\n                                                  : id === \"3\"\n                                                    ? \"G-Drive\"\n                                                    : id === \"4\"\n                                                      ? \"Instagram\"\n                                                      : id === \"5\"\n                                                        ? \"TikTok\"\n                                                        : \"G-Drive\"}\n                                        </Label>\n\n                                        <Input\n                                            type=\"text\"\n                                            id=\"input-tugas\"\n                                            value={formData.url}\n                                            onChange={(e) => {\n                                                setFormData(\n                                                    \"url\",\n                                                    e.target.value,\n                                                );\n                                                validateUrl();\n                                                setTugasId(tugas.id);\n                                            }}\n                                            placeholder={\n                                                id === \"1\"\n                                                    ? \"https://www.tiktok.com/...\"\n                                                    : id === \"2\"\n                                                      ? \"https://www.tiktok.com/...\"\n                                                      : id === \"3\"\n                                                        ? \"https://drive.google.com/...\"\n                                                        : id === \"4\"\n                                                          ? \"https://www.instagram.com/...\"\n                                                          : id === \"5\"\n                                                            ? \"https://www.tiktok.com/...\"\n                                                            : \"https://drive.google.com/...\"\n                                            }\n                                            className=\"mt-2\"\n                                        />\n                                        {!!urlError ? (\n                                            <span className=\"text-red-500 text-[12px]\">\n                                                {urlError}\n                                            </span>\n                                        ) : urlError === \"\" ? (\n                                            <span className=\"text-[12px] text-green-500\">\n                                                Link valid\n                                            </span>\n                                        ) : null}\n                                    </div>\n                                ))}\n\n                                {/* bg-candlelight-700 hover:bg-candlelight-700/90 */}\n                                {/* bg-jaffa-700 hover:bg-jaffa-700/90 */}\n\n                                <Button\n                                    onClick={handleSubmit}\n                                    disabled={!!urlError || !formData.url}\n                                    className=\"bg-jaffa-700 hover:bg-jaffa-700/90 w-full mt-5 transition duration-200 ease-in-out\"\n                                >\n                                    Submit Tugas {id}\n                                </Button>\n                            </div>\n                        </div>\n                    </MaxWidthWrapper>\n                </div>\n            </DefaultLayout>\n        </>\n    );\n}\n"],"names":["Page","id","tugasData","setTugasData","useState","urlError","setUrlError","csrfToken","setCsrfToken","tugasId","setTugasId","isSubmitted","setIsSubmitted","data","formData","setData","setFormData","post","put","processing","errors","useForm","tugas_id","url","useEffect","async","response","fetch","route","method","headers","ok","Error","status","json","tugas","console","log","error","validateUrl","useDebouncedCallback","test","split","children","jsx","DefaultLayout","isSolid","className","jsxRuntimeExports","MaxWidthWrapper","jsxs","Link","href","buttonVariants","variant","ChevronLeft","map","index","Label","htmlFor","Input","type","value","onChange","e","target","placeholder","Button","onClick","body","JSON","stringify","jawaban","yt","replace","disabled"],"mappings":"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"}