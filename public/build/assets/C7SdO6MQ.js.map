{"version":3,"file":"C7SdO6MQ.js","sources":["../../../resources/js/Pages/Dashboard/komdis/Page.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { usePage, router, Head } from \"@inertiajs/react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\nimport { Breadcrumbs } from \"@/Components/ui/breadcrumbs\";\nimport { Button } from \"@/Components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/Components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/Components/ui/tabs\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Textarea } from \"@/Components/ui/textarea\";\nimport { IconEdit, IconTrash } from \"@tabler/icons-react\";\n\nconst breadcrumbItems = [\n  { title: \"Ellysion Panel\", link: \"/dashboard\" },\n  { title: \"Komdis\", link: \"/dashboard/komdis\" },\n];\n\nexport default function Page({ auth, logs, userData: initialUserData, redirectToInput }: any) {\n  const [tab, setTab] = useState(redirectToInput ? \"input\" : \"list\");\n  const [userData, setUserData] = useState<any>(initialUserData || null);\n  const [kesalahan, setKesalahan] = useState(\"\");\n\n  // Handler untuk edit\n  const handleEdit = (logId: number) => {\n    router.get(route('dashboard.komdis.edit', logId));\n  };\n\n  // Handler untuk hapus\n  const handleDelete = (logId: number) => {\n    if (confirm('Yakin ingin menghapus data komdis ini?')) {\n      router.delete(route('dashboard.komdis.destroy', logId), {\n        onSuccess: () => {\n          // Refresh halaman atau update state\n          window.location.reload();\n        },\n        onError: (errors) => {\n          alert('Gagal menghapus data');\n        }\n      });\n    }\n  };\n\n  const handleSubmit = (e: any) => {\n    e.preventDefault();\n\n    router.post(\n      \"/dashboard/komdis/store\", // Perbaiki route\n      {\n        user_id: userData.id,\n        kesalahan,\n      },\n      {\n        onSuccess: () => {\n          setKesalahan(\"\");\n          setUserData(null);\n          setTab(\"list\");\n        },\n        onError: (errors) => {\n          console.error('Submit errors:', errors);\n          alert(errors.kesalahan || \"Terjadi kesalahan\");\n        },\n      }\n    );\n  };\n\n  return (\n    <>\n      <Head title=\"Log Komdis\" />\n      <DashboardLayout user={auth.user}>\n        <h2 className=\"text-3xl font-bold tracking-tight mb-4\">Log Komdis</h2>\n\n        <Breadcrumbs items={breadcrumbItems} />\n\n        <Tabs defaultValue=\"list\" value={tab} onValueChange={setTab} className=\"mt-4\">\n          <TabsList>\n            <TabsTrigger value=\"list\">Daftar Pelanggaran</TabsTrigger>\n            <TabsTrigger value=\"scan\">Scan QR</TabsTrigger>\n            {userData && <TabsTrigger value=\"input\">Isi Kesalahan</TabsTrigger>}\n          </TabsList>\n\n          <TabsContent value=\"list\">\n            <Card className=\"mt-4\">\n              <CardHeader>\n                <CardTitle>Data Pelanggaran</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full text-sm\">\n                    <thead>\n                      <tr className=\"text-left border-b\">\n                        <th className=\"p-2\">Nama</th>\n                        <th className=\"p-2\">NIM</th>\n                        <th className=\"p-2\">Kesalahan</th>\n                        <th className=\"p-2\">Status</th>\n                        <th className=\"p-2\">Tanggal</th>\n                        <th className=\"p-2\">Aksi</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {logs.map((log: any) => (\n                        <tr key={log.id} className=\"border-b hover:bg-gray-50\">\n                          <td className=\"p-2\">{log.user?.name}</td>\n                          <td className=\"p-2\">{log.user?.nim}</td>\n                          <td className=\"p-2\">{log.kesalahan}</td>\n                          <td className=\"p-2\">\n                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                              log.status === 'selesai' ? 'bg-green-100 text-green-800' :\n                              log.status === 'proses' ? 'bg-yellow-100 text-yellow-800' :\n                              'bg-gray-100 text-gray-800'\n                            }`}>\n                              {log.status || 'belum diproses'}\n                            </span>\n                          </td>\n                          <td className=\"p-2\">\n                            {new Date(log.created_at).toLocaleDateString('id-ID')}\n                          </td>\n                          <td className=\"p-2\">\n                            <div className=\"flex gap-2\">\n                              <Button\n                                size=\"sm\"\n                                onClick={() => handleEdit(log.id)}\n                                className=\"bg-gray-900 hover:bg-gray-800 text-white border-0 px-3 py-1.5 rounded-md\"\n                              >\n                                {/* <IconEdit size={16} className=\"mr-1\" /> */}\n                                Edit\n                              </Button>\n                              <Button\n                                size=\"sm\"\n                                onClick={() => handleDelete(log.id)}\n                                className=\"bg-red-500 hover:bg-red-600 text-white border-0 px-3 py-1.5 rounded-md\"\n                              >\n                                {/* <IconTrash size={16} className=\"mr-1\" /> */}\n                                Delete\n                              </Button>\n                            </div>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"scan\">\n            <div className=\"space-y-4\">\n              {/* QR Scanner hanya */}\n              <Card className=\"mt-4\">\n                <CardHeader>\n                  <CardTitle>Scan QR Code dengan Kamera</CardTitle>\n                </CardHeader>\n                <CardContent className=\"text-center\">\n                  <p className=\"text-gray-600 mb-4\">\n                    Klik tombol di bawah untuk membuka halaman QR scanner\n                  </p>\n                  <Button\n                    onClick={() => router.get(route('dashboard.komdis.scanner'))}\n                    className=\"w-full\"\n                    size=\"lg\"\n                  >\n                    ðŸ“· Buka QR Scanner\n                  </Button>\n                  <div className=\"text-xs text-gray-500 mt-4 space-y-1\">\n                    <p>â€¢ Scanner akan membuka halaman terpisah</p>\n                    <p>â€¢ Arahkan kamera ke QR code mahasiswa</p>\n                    <p>â€¢ Hasil scan otomatis akan kembali ke halaman ini</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"input\">\n            <Card className=\"mt-4\">\n              <CardHeader>\n                <CardTitle>\n                  Isi Kesalahan untuk {userData?.name || userData?.nama} ({userData?.nim})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">\n                      Kesalahan/Pelanggaran:\n                    </label>\n                    <Textarea\n                      placeholder=\"Masukkan detail kesalahan atau pelanggaran yang dilakukan\"\n                      value={kesalahan}\n                      onChange={(e) => setKesalahan(e.target.value)}\n                      required\n                      rows={4}\n                    />\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button type=\"submit\" disabled={!kesalahan.trim()}>\n                      Simpan Data\n                    </Button>\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        setUserData(null);\n                        setKesalahan(\"\");\n                        setTab(\"scan\");\n                      }}\n                    >\n                      Batal\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </DashboardLayout>\n    </>\n  );\n}\n"],"names":["breadcrumbItems","title","link","Page","auth","logs","userData","initialUserData","redirectToInput","tab","setTab","useState","setUserData","kesalahan","setKesalahan","jsxs","Fragment","children","jsx","Head","DashboardLayout","user","className","Breadcrumbs","items","Tabs","defaultValue","value","onValueChange","TabsList","TabsTrigger","TabsContent","Card","CardHeader","CardTitle","CardContent","map","log","name","nim","status","Date","created_at","toLocaleDateString","Button","size","onClick","handleEdit","logId","id","router","get","route","handleDelete","confirm","delete","onSuccess","window","location","reload","onError","errors","alert","nama","onSubmit","e","preventDefault","post","user_id","console","error","Textarea","placeholder","onChange","target","required","rows","type","disabled","trim","variant"],"mappings":"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"}