{"version":3,"file":"XT_4-Dy1.js","sources":["../../../resources/js/Pages/Dashboard/cui/Presensi.tsx"],"sourcesContent":["import { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { router, useForm } from \"@inertiajs/react\";\n\nimport { Button } from \"@/Components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/Components/ui/card\";\nimport { Input } from \"@/Components/ui/input\";\n\nimport { checkImageExists } from \"@/lib/utils\";\n\ntype DataMaba = {\n  message: string;\n  nama: string;\n  nim: string;\n  prodi: string;\n  pita: string;\n  riwayat: string;\n  profil_url: string;\n  qr_code: string | null;\n  kelompok: string;\n};\n\nfunction Presensi({ response }) {\n  const [error, setError] = useState(\"\");\n  const [dataMaba, setDataMaba] = useState<DataMaba | null>(null);\n  const [inputNim, setInputNim] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [imageSrc, setImageSrc] = useState<string | null>(null);\n\n  const handleSubmit = (e) => {\n    setInputNim(e.target.value);\n    debounced(e.target.value);\n  };\n\n  const handlePresensi = (qr_code: string) => {\n    router.post(route(\"cui.scan\"), {\n      qr_code: qr_code,\n    });\n  };\n\n  const getDataMaba = async (nim: string) => {\n    setLoading(true);\n    await fetch(route(\"dashboard.cui.detail\", { name: nim }))\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        } else {\n          response.json().then((data) => {\n            setError(data.message);\n            setDataMaba(null);\n          });\n        }\n      })\n      .then((json) => {\n        setError(\"\");\n        setDataMaba(json.data);\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  const testImage = async () => {\n    const url = dataMaba?.profil_url; // Replace with your image URL\n    const defaultUrl =\n      \"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png\"; // Replace with your default image URL\n    const finalUrl = await checkImageExists(url, defaultUrl);\n    setImageSrc(finalUrl as string);\n  };\n\n  const debounced = useDebouncedCallback(\n    // function\n    (value) => {\n      getDataMaba(value);\n    },\n    // delay in ms\n    500,\n  );\n\n  useEffect(() => {\n    testImage();\n  }, []);\n\n  // useEffect(() => {\n  //     if (data.qr_code) {\n  //         post(route(\"cui.scan\"));\n  //     }\n  // }, [data.qr_code]);\n  return (\n    <div className=\"space-y-4\">\n      <Card className=\"\">\n        <CardHeader className=\"flex flex-row items-center justify-between w-full pb-2 space-y-0\">\n          <CardTitle className=\"w-full text-lg font-bold text-center\">\n            Absensi CUI Maba\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center mt-2\">\n          <Button onClick={() => router.get(route(\"dashboard.cui.absensi\"))}>\n            Mulai Absen Maba\n          </Button>\n        </CardContent>\n      </Card>\n      <Input\n        disabled={loading}\n        value={inputNim}\n        onChange={handleSubmit}\n        placeholder=\"Cari Nama dan Kelompok. cth (Ujang 99)\"\n      />\n\n      {error && <p className=\"font-bold text-red-600\">{error}</p>}\n\n      {dataMaba && (\n        <div className=\"w-full\">\n          <p className=\"font-bold text-green-500\">{dataMaba.message}</p>\n          <div className=\"flex w-full gap-5 mt-3\">\n            <div>\n              <img\n                className=\"bg-fill object-cover w-56 h-64 mb-2 rounded-lg\"\n                src={imageSrc ?? \"\"}\n                alt=\"Foto profil\"\n              />\n              {dataMaba.pita === \"hijau\" && (\n                <div className=\"rounded-xl flex items-center justify-center h-10 font-bold text-white bg-green-500\">\n                  Pita Hijau\n                </div>\n              )}\n              {dataMaba.pita === \"kuning\" && (\n                <div>\n                  <div className=\"rounded-xl flex items-center justify-center h-10 font-bold text-white bg-yellow-400\">\n                    Pita Kuning\n                  </div>\n                  <p>Riwayat penyakit: {dataMaba.riwayat}</p>\n                </div>\n              )}\n              {dataMaba.pita === \"merah\" && (\n                <div>\n                  <div className=\"rounded-xl flex items-center justify-center h-10 font-bold text-white bg-red-600\">\n                    Pita Merah\n                  </div>\n                  <p>Riwayat penyakit: {dataMaba.riwayat}</p>\n                </div>\n              )}\n            </div>\n            <div>\n              <div className=\"ring-1 ring-black/30 rounded-xl p-2 text-xl\">\n                <p className=\"font-bold\">{dataMaba.nama}</p>\n                <p>{dataMaba.prodi}</p>\n                <p>{dataMaba.nim}</p>\n                <p>{dataMaba.kelompok}</p>\n              </div>\n              {dataMaba.qr_code ? (\n                <Button\n                  onClick={() => handlePresensi(dataMaba.qr_code ?? \"\")}\n                  className=\"w-full mt-2\"\n                >\n                  Presensi\n                </Button>\n              ) : null}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Presensi;\n"],"names":["Presensi","response","error","setError","useState","dataMaba","setDataMaba","inputNim","setInputNim","loading","setLoading","imageSrc","setImageSrc","debounced","useDebouncedCallback","value","async","nim","fetch","route","name","then","ok","json","data","message","finally","getDataMaba","useEffect","url","profil_url","finalUrl","checkImageExists","jsxs","className","children","Card","jsx","CardHeader","CardTitle","CardContent","Button","onClick","router","get","jsxRuntimeExports","Input","disabled","onChange","e","target","placeholder","src","alt","pita","riwayat","nama","prodi","kelompok","qr_code","handlePresensi","yt","post"],"mappings":"+OAwBA,SAASA,GAASC,SAAEA,IAClB,MAAOC,EAAOC,GAAYC,WAAS,KAC5BC,EAAUC,GAAeF,WAA0B,OACnDG,EAAUC,GAAeJ,WAAS,KAClCK,EAASC,GAAcN,YAAS,IAChCO,EAAUC,GAAeR,WAAwB,MA2ClDS,EAAYC,GAEfC,IAhCiBC,OAAOC,IACzBP,GAAW,SACLQ,MAAMC,MAAM,uBAAwB,CAAEC,KAAMH,KAC/CI,MAAMpB,IACL,GAAIA,EAASqB,GACX,OAAOrB,EAASsB,OAEhBtB,EAASsB,OAAOF,MAAMG,IACpBrB,EAASqB,EAAKC,SACdnB,EAAY,KAAI,GAEpB,IAEDe,MAAME,IACLpB,EAAS,IACTG,EAAYiB,EAAKC,KAAI,IAEtBE,SAAQ,KACPhB,GAAW,EAAK,GACjB,EAcDiB,CAAYZ,EAAK,GAGnB,KAaA,OAVFa,EAAAA,WAAU,KAjBQZ,WAChB,MAAMa,EAAgB,MAAVxB,OAAU,EAAAA,EAAAyB,WAGhBC,QAAiBC,EAAiBH,EADtC,4FAEFjB,EAAYmB,EAAkB,OAc7B,MAQDE,KAAC,MAAI,CAAAC,UAAU,YACbC,SAAA,GAACF,KAAAG,EAAA,CAAKF,UAAU,GACdC,SAAA,GAACE,IAAAC,EAAA,CAAWJ,UAAU,mEACpBC,SAAAE,EAAAA,IAACE,GAAUL,UAAU,uCAAuCC,gCAI7DE,EAAAA,IAAAG,EAAA,CAAYN,UAAU,wCACrBC,eAACM,EAAO,CAAAC,QAAS,IAAMC,EAAOC,IAAIzB,MAAM,0BAA2BgB,mCAKvEU,EAAAR,IAACS,EAAA,CACCC,SAAUtC,EACVM,MAAOR,EACPyC,SA5EgBC,IACRzC,EAAAyC,EAAEC,OAAOnC,OACXF,EAAAoC,EAAEC,OAAOnC,MAAK,EA2EpBoC,YAAY,2CAGbjD,KAASmC,IAAC,IAAE,CAAAH,UAAU,yBAA0BC,SAAMjC,IAEtDG,GACCwC,EAAAZ,KAAC,MAAI,CAAAC,UAAU,SACbC,SAAA,CAAAE,EAAAA,IAAC,IAAE,CAAAH,UAAU,2BAA4BC,SAAA9B,EAASoB,YAClDQ,KAAC,MAAI,CAAAC,UAAU,yBACbC,SAAA,QAAC,MACC,CAAAA,SAAA,CAAAU,EAAAR,IAAC,MAAA,CACCH,UAAU,iDACVkB,IAAKzC,GAAY,GACjB0C,IAAI,gBAEa,UAAlBhD,EAASiD,YACP,MAAI,CAAApB,UAAU,qFAAqFC,SAEpG,eAEiB,WAAlB9B,EAASiD,QACRrB,KAAC,MACC,CAAAE,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAIH,UAAU,sFAAsFC,SAErG,uBACC,IAAE,CAAAA,SAAA,CAAA,qBAAmB9B,EAASkD,cAGhB,UAAlBlD,EAASiD,QACRrB,KAAC,MACC,CAAAE,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAIH,UAAU,mFAAmFC,SAElG,sBACC,IAAE,CAAAA,SAAA,CAAA,qBAAmB9B,EAASkD,wBAIpC,MACC,CAAApB,SAAA,GAACF,KAAA,MAAA,CAAIC,UAAU,8CACbC,SAAA,CAAAE,EAAAA,IAAC,IAAE,CAAAH,UAAU,YAAaC,SAAA9B,EAASmD,SACnCnB,IAAC,IAAG,CAAAF,SAAA9B,EAASoD,UACbpB,IAAC,IAAG,CAAAF,SAAA9B,EAASY,QACboB,IAAC,IAAG,CAAAF,SAAA9B,EAASqD,cAEdrD,EAASsD,QACRd,EAAAR,IAACI,EAAA,CACCC,QAAS,KAAMkB,OAtHPD,EAsHsBtD,EAASsD,SAAW,QArHzDE,EAAAC,KAAK3C,MAAM,YAAa,CAC7BwC,YAFmB,IAACA,CAsH4C,EACpDzB,UAAU,cACXC,SAAA,aAGC,gBAOlB"}