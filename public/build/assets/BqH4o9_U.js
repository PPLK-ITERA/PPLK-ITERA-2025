import{W as e,r as a,j as i}from"./DC6m5fxZ.js";import{D as s}from"./DK9QbAQp.js";import{D as r}from"./BeryW3Yn.js";import{c as t}from"./Vr4_5iVq.js";import{B as n}from"./eCUVu0Ub.js";import{I as l}from"./V1bxGyBr.js";import{L as o}from"./D_u_jg3I.js";import{t as m}from"./BDuM9CfJ.js";import{D as d,a as c,b as h,e as p,c as j}from"./DYVlCk6u.js";import{I as x}from"./Dv_j3Wt6.js";import{B as g}from"./Cuv2ImGC.js";import{D as u}from"./CHvKQSkD.js";import{T as f}from"./CWn6w1y_.js";import{I as k}from"./CMNCclCc.js";import"./DEf7FhSo.js";import"./YCL8n3XI.js";import"./FKrtAZ_w.js";import"./DqI9-jNe.js";import"./BIV4RXrC.js";import"./Dieba0GV.js";import"./re-kSsK4.js";import"./BSS3G3RI.js";import"./ByKTIQIh.js";import"./BZtDV8eV.js";import"./Dq6AiHaF.js";import"./CrNn0rwp.js";import"./inkdLMOk.js";function b({materi:s}){const{data:r,setData:d,post:c,put:h,processing:p,errors:j}=e(s),[x,g]=a.useState(null),[u,f]=a.useState(null),k=t((async()=>{if(console.log("validating url",r.link_materi),!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(r.link_materi))return void g("link harus dari Google Drive");let e=r.link_materi.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${e}?key=AIzaSyB4-JCqVpt3dC5MlC0Q6yQOSYG0uysdvwc`)).ok?g(""):g("Link drive belum publik, silahkan coba lagi")}),200);return i.jsxs("form",{"aria-describedby":"form",className:"grid gap-4 py-4",onSubmit:e=>{e.preventDefault(),s?(console.log(r),h(route("dashboard.materi.update"),{onError:()=>{m({title:"Uh oh! Gagal mengupdate Materi.",description:j.nama_materi||j.link_materi})},onSuccess:()=>{m({title:"Berhasil!",description:"Materi berhasil diupdate."})}}),window.location.reload()):(c(route("dashboard.materi.store"),{onError:()=>{m({title:"Uh oh! Gagal mengupload Materi.",description:j.nama_materi||j.link_materi})},onSuccess:()=>{m({title:"Berhasil!",description:"Materi berhasil diupload."})}}),window.location.reload())},children:[i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"nama_materi",className:"text-right",children:"Nama Materi"}),i.jsx(l,{id:"nama_materi",name:"nama_materi",required:!0,type:"text",value:r.nama_materi,maxLength:500,className:"col-span-3",onChange:e=>d("nama_materi",e.target.value)})]}),i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"hari",className:"text-right",children:"Hari Ke-"}),i.jsx(l,{id:"hari",name:"hari",required:!0,type:"text",value:r.hari,maxLength:1,className:"col-span-3",onChange:e=>{d("hari",e.target.value)}})]}),i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"link_materi",className:"text-right",children:"Link Google Drive Materi"}),i.jsx(l,{id:"link_materi",name:"link_materi",required:!0,type:"text",value:r.link_materi,maxLength:500,className:"col-span-3",onChange:e=>{d("link_materi",e.target.value),k()}})]}),i.jsxs("div",{className:"place-content-center flex items-center justify-between gap-4 text-right",children:[i.jsx(n,{className:"bg-orange-500",size:"sm",onClick:()=>k(),children:"Refresh Link"}),x?i.jsx("p",{className:"text-sm text-red-500",children:x}):""===x?i.jsx("p",{className:"text-sm text-green-500",children:"Link valid"}):null]}),i.jsx("div",{className:"place-content-center flex items-center justify-between gap-4 mt-4 text-right",children:i.jsxs(n,{size:"sm",type:"submit",className:"w-full",disabled:!!x||!!u,children:[s?"Perbarui":"Tambahkan"," Materi"]})})]})}const N=({materi:s})=>{const{data:t,setData:l,delete:o,processing:g,errors:u}=e(s),[f,k]=a.useState(!1),[N,v]=a.useState(!1);return a.useEffect((()=>{(f||N)&&l(s)}),[f,N,s,l]),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"flex gap-1 p-2",children:[i.jsxs(d,{open:f,onOpenChange:k,children:[i.jsx(c,{asChild:!0,children:i.jsxs(n,{className:"bg-red-500",onClick:()=>k(!0),children:[i.jsx(x,{size:18}),i.jsx("span",{children:"Hapus"})]})}),i.jsxs(h,{className:"sm:max-w-[425px]",children:[i.jsx(p,{children:i.jsx(j,{children:"Hapus Materi"})}),i.jsxs("div",{children:[i.jsxs("p",{children:["Apakah anda yakin ingin menghapus materi"," ",s.nama_materi,"?"]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx(r,{asChild:!0,children:i.jsx(n,{children:"Batal"})}),i.jsx(n,{onClick:function(){o(route("dashboard.materi.destroy"),{onError:()=>{m({title:"Uh oh! Gagal menghapus Materi.",description:u.nama_materi||u.link_materi})},onSuccess:()=>{m({title:"Berhasil!",description:"Materi berhasil dihapus."})}}),window.location.reload()},className:"bg-red-500",children:"Hapus"})]})]})]})]}),i.jsxs(d,{open:N,onOpenChange:v,children:[i.jsx(c,{asChild:!0,children:i.jsx(n,{onClick:()=>v(!0),children:i.jsx("span",{children:"Edit"})})}),i.jsxs(h,{className:"sm:max-w-[425px]",children:[i.jsx(p,{children:i.jsx(j,{children:"Edit Materi"})}),i.jsx(b,{materi:s})]})]})]})})},v=[{title:"Dashboard",link:"/dashboard"},{title:"Materi",link:"/dashboard/materi"}];function w({auth:e,response:a}){const r=[{id:"no",header:"No",cell:({row:e})=>e.index+1},{id:"nama_materi",accessorKey:"materi.nama_materi",header:"Nama"},{id:"link_materi",accessorKey:"materi.link_materi",header:"Link Materi"},{id:"hari",accessorKey:"materi.hari",header:"Hari Ke"},{id:"action",header:"Aksi",cell:({row:e})=>(console.log(e.original.materi),i.jsx(N,{materi:e.original.materi}))}];return i.jsxs(s,{user:e.user,children:[i.jsx(g,{items:v}),i.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Atur Materi"}),i.jsx("div",{className:"place-content-start flex w-full",children:i.jsxs(d,{children:[i.jsx(c,{asChild:!0,children:i.jsxs(n,{children:[i.jsx(k,{size:18}),i.jsx("span",{children:"Tambah Materi"})]})}),i.jsxs(h,{children:[i.jsx(p,{children:i.jsx(j,{children:"Tambah Materi"})}),i.jsx(b,{})]})]})}),i.jsx(u,{searchKey:"name",columns:r,apiEndpoint:route("dashboard.materi.data"),title:"Data Materi",description:"Data Materi yang telah diupload."}),i.jsx(f,{})]})}export{w as default};
