{"version":3,"file":"RaZKjq59.js","sources":["../../../resources/js/Components/dashboard/booklet/BookletForm.tsx","../../../resources/js/Components/dashboard/booklet/BookletCellActions.tsx","../../../resources/js/Pages/Dashboard/booklet/Page.tsx"],"sourcesContent":["import { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { FormEvent, useState } from \"react\";\n\nimport { useForm } from \"@inertiajs/react\";\n\nimport { Button } from \"@/Components/ui/button\";\nimport { Input } from \"@/Components/ui/input\";\nimport { Label } from \"@/Components/ui/label\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\ntype Props = {\n  booklet?: Booklet;\n};\n\nfunction BookletForm({ booklet }: Props) {\n  const { toast } = useToast();\n\n  const { data, setData, post, put, processing, errors } =\n    useForm<Booklet>(booklet);\n  const [urlError, setUrlError] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const validateUrl = useDebouncedCallback(async () => {\n    if (!/^https:\\/\\/(www\\.)?\\w+\\.google\\.com\\/.*$/g.test(data.url_booklet)) {\n      setUrlError(\"link harus dari Google Drive\");\n      return;\n    }\n\n    let id = data.url_booklet.split(\"/\")[5];\n\n    let response = await fetch(\n      `https://www.googleapis.com/drive/v2/files/${id}?key=${import.meta.env.VITE_GOOGLE_API_KEY}`,\n    );\n\n    if (!response.ok) {\n      setUrlError(\"Link drive belum publik, silahkan coba lagi\");\n      return;\n    }\n\n    setUrlError(\"\");\n  }, 200);\n\n  function onSubmit() {\n    toast({\n      title: \"Mohon tunggu sebentar...\",\n      description: \"Sedang mengupload Booklet...\",\n    });\n\n    if (booklet) {\n      put(route(\"dashboard.booklet.update\", booklet.id), {\n        onError: () => {\n          toast({\n            title: \"Uh oh! Gagal mengupdate Booklet.\",\n            description: errors.nama_booklet || errors.url_booklet,\n          });\n        },\n        onSuccess: () => {\n          toast({\n            title: \"Berhasil!\",\n            description: \"Booklet berhasil diupdate.\",\n          });\n        },\n      });\n      window.location.reload();\n    } else {\n      post(route(\"dashboard.booklet.store\"), {\n        onError: () => {\n          toast({\n            title: \"Uh oh! Gagal mengupload Booklet.\",\n            description: errors.nama_booklet || errors.url_booklet,\n          });\n        },\n        onSuccess: () => {\n          toast({\n            title: \"Berhasil!\",\n            description: \"Booklet berhasil diupload.\",\n          });\n        },\n      });\n      window.location.reload();\n    }\n  }\n\n  return (\n    <>\n      <form\n        aria-describedby=\"form\"\n        className=\"grid gap-4 py-4\"\n        onSubmit={(e: FormEvent) => {\n          e.preventDefault();\n          onSubmit();\n        }}\n      >\n        <div className=\"grid items-center grid-cols-4 gap-4\">\n          <Label htmlFor=\"nama_booklet\" className=\"text-right\">\n            Nama Booklet\n          </Label>\n          <Input\n            id=\"nama_booklet\"\n            name=\"nama_booklet\"\n            required\n            type=\"text\"\n            value={data.nama_booklet}\n            maxLength={500}\n            className=\"col-span-3\"\n            onChange={(e) => setData(\"nama_booklet\", e.target.value)}\n          />\n        </div>\n        <div className=\"grid items-center grid-cols-4 gap-4\">\n          <Label htmlFor=\"url_booklet\" className=\"text-right\">\n            Link Google Drive Booklet\n          </Label>\n          <Input\n            id=\"url_booklet\"\n            name=\"url_booklet\"\n            required\n            type=\"text\"\n            value={data.url_booklet}\n            maxLength={500}\n            className=\"col-span-3\"\n            onChange={(e) => {\n              setData(\"url_booklet\", e.target.value);\n              validateUrl();\n            }}\n          />\n        </div>\n        <div className=\"place-content-center flex items-center justify-between gap-4 text-right\">\n          <Button\n            type=\"button\"\n            className=\"bg-orange-500\"\n            size={\"sm\"}\n            onClick={validateUrl}\n          >\n            Refresh Link\n          </Button>\n          {!!urlError ? (\n            <p className=\"text-sm text-red-500\">{urlError}</p>\n          ) : urlError === \"\" ? (\n            <p className=\"text-sm text-green-500\">Link valid</p>\n          ) : null}\n        </div>\n        <div className=\"place-content-center flex items-center justify-between gap-4 mt-4 text-right\">\n          <Button\n            size=\"sm\"\n            type=\"submit\"\n            className={`w-full`}\n            disabled={!!urlError || !!error}\n          >\n            {booklet ? \"Perbarui\" : \"Tambahkan\"} Booklet\n          </Button>\n        </div>\n      </form>\n    </>\n  );\n}\n\nexport default BookletForm;\n","import { DialogClose } from \"@radix-ui/react-dialog\";\n\nimport { FormEvent, useEffect, useState } from \"react\";\n\nimport { router, useForm } from \"@inertiajs/react\";\n\nimport { IconTrashFilled } from \"@tabler/icons-react\";\n\nimport BookletForm from \"@/Components/dashboard/booklet/BookletForm\";\nimport { Button } from \"@/Components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/Components/ui/dialog\";\nimport { toast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\ninterface BookletActionProps {\n  booklet: Booklet;\n}\n\nexport const BookletCellActions: React.FC<BookletActionProps> = ({\n  booklet,\n}) => {\n  const {\n    data,\n    setData,\n    delete: del,\n    processing,\n    errors,\n  } = useForm<Booklet>(booklet);\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [editDialogOpen, setEditDialogOpen] = useState(false);\n\n  useEffect(() => {\n    if (deleteDialogOpen || editDialogOpen) {\n      setData(booklet);\n    }\n  }, [deleteDialogOpen, editDialogOpen, booklet, setData]);\n\n  function onDelete() {\n    del(route(\"dashboard.booklet.destroy\", booklet.id), {\n      onError: () => {\n        toast({\n          title: \"Uh oh! Gagal menghapus Booklet.\",\n          description: errors.nama_booklet || errors.url_booklet,\n        });\n      },\n      onSuccess: () => {\n        toast({\n          title: \"Berhasil!\",\n          description: \"Booklet berhasil dihapus.\",\n        });\n      },\n    });\n    window.location.reload();\n  }\n\n  return (\n    <>\n      <div className=\"flex gap-1 p-2\">\n        <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n          <DialogTrigger asChild>\n            <Button\n              className=\"bg-red-500\"\n              onClick={() => setDeleteDialogOpen(true)}\n            >\n              <IconTrashFilled size={18} />\n              <span>Hapus</span>\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-[425px]\">\n            <DialogHeader>\n              <DialogTitle>Hapus Booklet</DialogTitle>\n            </DialogHeader>\n            <div>\n              <p>\n                Apakah anda yakin ingin menghapus booklet {booklet.nama_booklet}\n                ?\n              </p>\n              <div className=\"flex justify-end gap-2 mt-4\">\n                <DialogClose asChild>\n                  <Button>Batal</Button>\n                </DialogClose>\n                <Button onClick={onDelete} className=\"bg-red-500\">\n                  Hapus\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>\n          <DialogTrigger asChild>\n            <Button onClick={() => setEditDialogOpen(true)}>\n              <span>Edit</span>\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-[425px]\">\n            <DialogHeader>\n              <DialogTitle>Edit Booklet</DialogTitle>\n            </DialogHeader>\n            <BookletForm booklet={booklet} />\n          </DialogContent>\n        </Dialog>\n      </div>\n    </>\n  );\n};\n","import { ColumnDef } from \"@tanstack/react-table\";\nimport { format } from \"date-fns\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport React, { FormEvent, useEffect, useState } from \"react\";\n\nimport { useForm } from \"@inertiajs/react\";\n\nimport { CalendarIcon } from \"lucide-react\";\n\nimport { IconPlus } from \"@tabler/icons-react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\n\nimport { BookletCellActions } from \"@/Components/dashboard/booklet/BookletCellActions\";\nimport BookletForm from \"@/Components/dashboard/booklet/BookletForm\";\nimport { Breadcrumbs } from \"@/Components/ui/breadcrumbs\";\nimport { Button } from \"@/Components/ui/button\";\nimport { DataTable } from \"@/Components/ui/data-table\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/Components/ui/dialog\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { toast, useToast } from \"@/Components/ui/use-toast\";\n\nimport { Booklet } from \"@/lib/types/Booklet\";\n\nconst breadcrumbItems = [\n  { title: \"Dashboard\", link: \"/dashboard\" },\n  { title: \"Booklet\", link: \"/dashboard/booklet\" },\n];\n\ninterface BookletDataResponse {\n  no: number;\n  booklet: Booklet;\n}\n\nexport default function Page({ auth, response }) {\n  const columns: ColumnDef<BookletDataResponse>[] = [\n    {\n      id: \"no\",\n      header: \"No\",\n      cell: ({ row }) => row.index + 1,\n    },\n    {\n      id: \"nama_booklet\",\n      accessorKey: \"booklet.nama_booklet\",\n      header: \"Nama\",\n    },\n    {\n      id: \"url_booklet\",\n      accessorKey: \"booklet.url_booklet\",\n      header: \"Link Booklet\",\n    },\n    {\n      id: \"action\",\n      header: \"Aksi\",\n      cell: ({ row }) => <BookletCellActions booklet={row.original.booklet} />,\n    },\n  ];\n\n  return (\n    <DashboardLayout user={auth.user}>\n      <Breadcrumbs items={breadcrumbItems} />\n      <h2 className=\"text-3xl font-bold tracking-tight\">Atur Booklet</h2>\n\n      <div className=\"place-content-start flex w-full\">\n        {/* add dialog */}\n        <Dialog>\n          <DialogTrigger asChild>\n            <Button>\n              <IconPlus size={18} />\n              <span>Tambah Booklet</span>\n            </Button>\n          </DialogTrigger>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Tambah Booklet</DialogTitle>\n            </DialogHeader>\n            <BookletForm />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <DataTable\n        searchKey=\"name\"\n        columns={columns}\n        apiEndpoint={route(\"dashboard.booklet.data\")}\n        title={\"Data Booklet\"}\n        description={\"Data Booklet yang telah diupload.\"}\n      />\n      <Toaster />\n    </DashboardLayout>\n  );\n}\n"],"names":["BookletForm","booklet","toast","useToast","data","setData","post","put","processing","errors","useForm","urlError","setUrlError","useState","error","setError","validateUrl","useDebouncedCallback","async","test","url_booklet","id","split","fetch","define_import_meta_env_default","VITE_GOOGLE_API_KEY","ok","Fragment","children","jsxRuntimeExports","jsxs","className","onSubmit","e","preventDefault","title","description","route","onError","nama_booklet","onSuccess","window","location","reload","jsx","Label","htmlFor","Input","name","required","type","value","maxLength","onChange","target","Button","size","onClick","disabled","BookletCellActions","delete","del","deleteDialogOpen","setDeleteDialogOpen","editDialogOpen","setEditDialogOpen","useEffect","Dialog","open","onOpenChange","DialogTrigger","asChild","IconTrashFilled","DialogContent","DialogHeader","DialogTitle","DialogClose","breadcrumbItems","link","Page","auth","response","columns","header","cell","row","index","accessorKey","original","DashboardLayout","user","Breadcrumbs","items","IconPlus","DataTable","searchKey","apiEndpoint","Toaster"],"mappings":"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"}