import{r as t,W as s,j as a,a as e,y as r}from"./Bz8SZWRk.js";import{c as i}from"./DCuDhOXb.js";import{D as o}from"./BZoNY6fk.js";import{M as n}from"./BTz_fBL6.js";import{b as l,B as c}from"./Cj141LS1.js";import{I as m}from"./DLX4v8wU.js";import{L as d}from"./DO4vQnho.js";import{T as p}from"./DjQhxjbt.js";import{u}from"./C_Fr9O0H.js";import{C as h}from"./BreUAuRd.js";import"./BP7_iprW.js";import"./7ap_y-tI.js";import"./BZtDV8eV.js";import"./BPBzuKzv.js";import"./bKzaXQS6.js";import"./5epn7TdO.js";import"./DntUL_3w.js";import"./DqPY_V92.js";import"./ySNKc6ss.js";import"./CY9_FK64.js";import"./D0R_arE2.js";var g={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_NAME:"PPLK 2024"};function j({id:j}){const[f,w]=t.useState(null),[x,k]=t.useState(null),[v,b]=t.useState(""),[T,y]=t.useState(0),[E,N]=t.useState(!1),{toast:S}=u(),{data:P,setData:D,post:G,put:_,processing:C,errors:L}=s({tugas_id:0,url:""});t.useEffect((()=>{(async()=>{try{const t=await fetch(route("mading.tugas",{id:j}),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("HTTP status "+t.status);const s=await t.json();w(s.tugas),N(s.isSubmitted)}catch(t){S({title:"Error",description:"Gagal mendapatkan data tugas",variant:"destructive"})}})();(async()=>{try{const t=await fetch(route("csrf")),s=await t.json();b(s.csrfToken)}catch(t){console.error("Error fetching CSRF token:",t)}})()}),[]);const O=i((()=>{/^https:\/\/(www\.)?tiktok\.com\/.*$/g.test(P.url)?k(""):k("link harus dari TikTok")}),200),I=i((async()=>{/^https:\/\/(www\.)?instagram\.com\/.*$/g.test(P.url)?k(""):k("link harus dari Instagram")}),200),R=i((async()=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(P.url))return void k("link harus dari Google Drive");let t=P.url.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${t}?key=${g.VITE_GOOGLE_API_KEY}`)).ok?k(""):k("Link drive belum publik, silahkan coba lagi")}),200);return a.jsxs(a.Fragment,{children:[a.jsx(o,{isSolid:!0,children:a.jsx("div",{className:"bg-pattern-white pt-28",children:a.jsx(n,{className:"min-h-screen",children:a.jsxs("div",{className:"px-2.5 bg-white/80 py-5 rounded-md md:px-5 lg:px-10 xl:px-28",children:[a.jsxs(e,{href:route("mading"),className:`${l({variant:"outline"})} bg-transparent hover:bg-transparent shadow-none items-center border-none flex gap-2 -ml-5`,children:[a.jsx(h,{}),a.jsx("span",{children:"Kembali"})]}),a.jsxs("h2",{"data-aos":"fade-down","data-aos-duration":"1000",className:"font-montserrat font-bold text-jaffa-700 w-fit pt-[30px] text-3xl",children:["Pengumpulan Tugas Day - ",j]}),a.jsxs("div",{className:"flex flex-col mt-10",children:[null==f?void 0:f.tugas.map(((t,s)=>a.jsxs("div",{className:"flex flex-col",children:[a.jsxs(d,{htmlFor:"input-tugas",className:"text-left",children:["Link"," ","1"===j||"2"===j?"TikTok":"3"===j?"G-Drive":"4"===j?"Instagram":"5"===j?"TikTok":"G-Drive"]}),a.jsx(m,{type:"text",id:"input-tugas",value:P.url,onChange:s=>{D("url",s.target.value),(t=>{switch(t){case 1:case 2:case 5:O();break;case 3:case 6:R();break;case 4:I()}})(t.id),y(t.id)},placeholder:"1"===j||"2"===j?"https://www.tiktok.com/...":"3"===j?"https://drive.google.com/...":"4"===j?"https://www.instagram.com/...":"5"===j?"https://www.tiktok.com/...":"https://drive.google.com/...",className:"mt-2"}),x?a.jsx("span",{className:"text-red-500 text-[12px]",children:x}):""===x?a.jsx("span",{className:"text-[12px] text-green-500",children:"Link valid"}):null]},s))),a.jsxs(c,{onClick:async()=>{try{const t=await fetch(route("mading.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":v},body:JSON.stringify({tugas_id:T,jawaban:P.url})});if(!t.ok)throw new Error("HTTP status "+t.status);r.replace(route("mading"))}catch(t){S({title:"Error",description:"Gagal mensubmit tugas",variant:"destructive"})}},disabled:!!x||!P.url,className:"bg-jaffa-700 hover:bg-jaffa-700/90 w-full mt-5 transition duration-200 ease-in-out",children:["Submit Tugas ",j]})]})]})})})}),a.jsx(p,{})]})}export{j as default};
