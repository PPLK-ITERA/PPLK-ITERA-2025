import{r as t,W as s,j as a,a as e,y as r}from"./DPkeyV0Z.js";import{c as i}from"./G8BpqsGO.js";import{D as o}from"./CfEnjWct.js";import{M as n}from"./UahXY1O9.js";import{b as l,B as m}from"./CGKbRqdy.js";import{I as c}from"./C7BOBBkI.js";import{L as d}from"./CfsfQZha.js";import{T as p}from"./BZKv3Yx_.js";import{u}from"./Cbch3Dsg.js";import{C as h}from"./BW33h4_-.js";import"./CnTOdDuj.js";import"./7ap_y-tI.js";import"./BZtDV8eV.js";import"./Ba4YecwC.js";import"./Dl7M0piC.js";import"./DC8fWKBq.js";import"./BZMESt7D.js";import"./BDTiwGHV.js";import"./CErQCflw.js";import"./CSnwJ49B.js";import"./DQVYKXaw.js";function g({id:g}){const[j,f]=t.useState(null),[w,x]=t.useState(null),[k,v]=t.useState(""),[y,b]=t.useState(0),[T,N]=t.useState(!1),{toast:S}=u(),{data:C,setData:E,post:G,put:D,processing:$,errors:F}=s({tugas_id:0,url:""});t.useEffect((()=>{(async()=>{try{const t=await fetch(route("mading.tugas",{id:g}),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("HTTP status "+t.status);const s=await t.json();f(s.tugas),N(s.isSubmitted)}catch(t){S({title:"Error",description:"Gagal mendapatkan data tugas",variant:"destructive"})}})();(async()=>{try{const t=await fetch(route("csrf")),s=await t.json();v(s.csrfToken)}catch(t){console.error("Error fetching CSRF token:",t)}})()}),[]),i((()=>{/^https:\/\/(www\.)?tiktok\.com\/.*$/g.test(C.url)?x(""):x("link harus dari TikTok")}),200),i((async()=>{/^https:\/\/(www\.)?instagram\.com\/.*$/g.test(C.url)?x(""):x("link harus dari Instagram")}),200),i((async()=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(C.url))return void x("link harus dari Google Drive");let t=C.url.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${t}?key=AIzaSyB4-JCqVpt3dC5MlC0Q6yQOSYG0uysdvwc`)).ok?x(""):x("Link drive belum publik, silahkan coba lagi")}),200);return a.jsxs(a.Fragment,{children:[a.jsx(o,{isSolid:!0,children:a.jsx("div",{className:"bg-pattern-white pt-28",children:a.jsx(n,{className:"min-h-screen",children:a.jsxs("div",{className:"px-2.5 bg-white/80 py-5 rounded-md md:px-5 lg:px-10 xl:px-28",children:[a.jsxs(e,{href:route("mading"),className:`${l({variant:"outline"})} bg-transparent hover:bg-transparent shadow-none items-center border-none flex gap-2 -ml-5`,children:[a.jsx(h,{}),a.jsx("span",{children:"Kembali"})]}),a.jsxs("h2",{"data-aos":"fade-down","data-aos-duration":"1000",className:"font-montserrat font-bold text-jaffa-700 w-fit pt-[30px] text-3xl",children:["Pengumpulan Tugas Day - ",g]}),a.jsxs("div",{className:"flex flex-col mt-10",children:[null==j?void 0:j.tugas.map(((t,s)=>a.jsxs("div",{className:"flex flex-col",children:[a.jsxs(d,{htmlFor:"input-tugas",className:"text-left",children:["Link"," ","1"===g||"2"===g?"TikTok":"3"===g?"G-Drive":"4"===g?"Instagram":"5"===g?"TikTok":"G-Drive"]}),a.jsx(c,{type:"text",id:"input-tugas",value:C.url,onChange:s=>{E("url",s.target.value),b(t.id)},placeholder:"1"===g||"2"===g?"https://www.tiktok.com/...":"3"===g?"https://drive.google.com/...":"4"===g?"https://www.instagram.com/...":"5"===g?"https://www.tiktok.com/...":"https://drive.google.com/...",className:"mt-2"}),w?a.jsx("span",{className:"text-red-500 text-[12px]",children:w}):""===w?a.jsx("span",{className:"text-[12px] text-green-500",children:"Link valid"}):null]},s))),a.jsxs(m,{onClick:async()=>{try{const t=await fetch(route("mading.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":k},body:JSON.stringify({tugas_id:y,jawaban:C.url})});if(!t.ok)throw new Error("HTTP status "+t.status);r.replace(route("mading"))}catch(t){S({title:"Error",description:"Gagal mensubmit tugas",variant:"destructive"})}},disabled:!!w||!C.url,className:"bg-jaffa-700 hover:bg-jaffa-700/90 w-full mt-5 transition duration-200 ease-in-out",children:["Submit Tugas ",g]})]})]})})})}),a.jsx(p,{})]})}export{g as default};
