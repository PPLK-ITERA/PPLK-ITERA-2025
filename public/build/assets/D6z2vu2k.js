import{G as e,r as s,j as o,S as t}from"./CIhTuXRG.js";import{D as a}from"./Danl8LCu.js";import{D as l}from"./pPu53TBx.js";import{c as r}from"./BBjzDl6B.js";import{B as i}from"./DwymkT3b.js";import{I as n}from"./CPRzyMxG.js";import{L as d}from"./CHkZVxBN.js";import{u as c,t as m}from"./1McHOag7.js";import{D as h,f as p,a as j,b as x,c as u}from"./DAyg1axn.js";import{I as k}from"./Cz3wq7C7.js";import{B as b}from"./1uhK2nqK.js";import{D as g}from"./C1SDZXE5.js";import{T as f}from"./DjNSAiLG.js";import{I as v}from"./CcGaQEMC.js";import"./BygzdrgF.js";import"./C2QWHnGH.js";import"./BKM7wPLr.js";import"./DUrDnauO.js";import"./4Cw5M-eZ.js";import"./CUBboHbg.js";import"./Ccpv_xr2.js";import"./BEtUhvfm.js";import"./A_J3cprA.js";import"./C0u18CNn.js";import"./BSLcxgLe.js";import"./DJ2r0t7J.js";import"./Ct5yE-lb.js";import"./BXR7IHJS.js";import"./BncFCPdx.js";function y({booklet:t}){const{toast:a}=c(),{data:l,setData:m,post:h,put:p,errors:j}=e(t),[x,u]=s.useState(null),[k,b]=s.useState(null),g=r((async()=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(l.url_booklet))return void u("link harus dari Google Drive");let e=l.url_booklet.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${e}?key=AIzaSyBhQpkTndFEvQEvUCY0MegZhYII5fqgUcQ`)).ok?u(""):u("Link drive belum publik, silahkan coba lagi")}),200);return o.jsx(o.Fragment,{children:o.jsxs("form",{"aria-describedby":"form",className:"grid gap-4 py-4",onSubmit:e=>{e.preventDefault(),a({title:"Mohon tunggu sebentar...",description:"Sedang mengupload Booklet..."}),t?(p(route("dashboard.booklet.update",t.id),{onError:()=>{a({title:"Uh oh! Gagal mengupdate Booklet.",description:j.nama_booklet||j.url_booklet})},onSuccess:()=>{a({title:"Berhasil!",description:"Booklet berhasil diupdate."})}}),window.location.reload()):(h(route("dashboard.booklet.store"),{onError:()=>{a({title:"Uh oh! Gagal mengupload Booklet.",description:j.nama_booklet||j.url_booklet})},onSuccess:()=>{a({title:"Berhasil!",description:"Booklet berhasil diupload."})}}),window.location.reload())},children:[o.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[o.jsx(d,{htmlFor:"nama_booklet",className:"text-right",children:"Nama Booklet"}),o.jsx(n,{id:"nama_booklet",name:"nama_booklet",required:!0,type:"text",value:l.nama_booklet,maxLength:500,className:"col-span-3",onChange:e=>m("nama_booklet",e.target.value)})]}),o.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[o.jsx(d,{htmlFor:"day",className:"text-right",children:"Day"}),o.jsxs("select",{id:"day",name:"day",required:!0,value:l.day,className:"col-span-3",onChange:e=>m("day",e.target.value),children:[o.jsx("option",{value:"",children:"Pilih Day"}),o.jsx("option",{value:"1",children:"Day 1"}),o.jsx("option",{value:"2",children:"Day 2"}),o.jsx("option",{value:"3",children:"Day 3"}),o.jsx("option",{value:"4",children:"Day 4"}),o.jsx("option",{value:"5",children:"Day 5"}),o.jsx("option",{value:"6",children:"Day 6"})]})]}),o.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[o.jsx(d,{htmlFor:"url_booklet",className:"text-right",children:"Link Google Drive Booklet"}),o.jsx(n,{id:"url_booklet",name:"url_booklet",required:!0,type:"text",value:l.url_booklet,maxLength:500,className:"col-span-3",onChange:e=>{m("url_booklet",e.target.value),g()}})]}),o.jsxs("div",{className:"place-content-center flex items-center justify-between gap-4 text-right",children:[o.jsx(i,{type:"button",className:"bg-orange-500",size:"sm",onClick:g,children:"Refresh Link"}),x?o.jsx("p",{className:"text-sm text-red-500",children:x}):""===x?o.jsx("p",{className:"text-sm text-green-500",children:"Link valid"}):null]}),o.jsx("div",{className:"place-content-center flex items-center justify-between gap-4 mt-4 text-right",children:o.jsxs(i,{size:"sm",type:"submit",className:"w-full bg-[#BE3F00]",disabled:!!x||!!k,children:[t?"Perbarui":"Tambahkan"," Booklet"]})})]})})}const B=({booklet:t})=>{const{setData:a,delete:r,errors:n}=e(t),[d,c]=s.useState(!1),[b,g]=s.useState(!1);return s.useEffect((()=>{(d||b)&&a(t)}),[d,b,t,a]),o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex gap-1 p-2",children:[o.jsxs(h,{open:d,onOpenChange:c,children:[o.jsx(p,{asChild:!0,children:o.jsxs(i,{className:"bg-red-500",onClick:()=>c(!0),children:[o.jsx(k,{size:18}),o.jsx("span",{children:"Hapus"})]})}),o.jsxs(j,{className:"sm:max-w-[425px]",children:[o.jsx(x,{children:o.jsx(u,{children:"Hapus Booklet"})}),o.jsxs("div",{children:[o.jsxs("p",{children:["Apakah anda yakin ingin menghapus booklet ",t.nama_booklet,"?"]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[o.jsx(l,{asChild:!0,children:o.jsx(i,{children:"Batal"})}),o.jsx(i,{onClick:function(){r(route("dashboard.booklet.destroy",t.id),{onError:()=>{m({title:"Uh oh! Gagal menghapus Booklet.",description:n.nama_booklet||n.url_booklet})},onSuccess:()=>{m({title:"Berhasil!",description:"Booklet berhasil dihapus."})}}),window.location.reload()},className:"bg-red-500",children:"Hapus"})]})]})]})]}),o.jsxs(h,{open:b,onOpenChange:g,children:[o.jsx(p,{asChild:!0,children:o.jsx(i,{onClick:()=>g(!0),children:o.jsx("span",{children:"Edit"})})}),o.jsxs(j,{className:"sm:max-w-[425px]",children:[o.jsx(x,{children:o.jsx(u,{children:"Edit Booklet"})}),o.jsx(y,{booklet:t})]})]})]})})},N=[{title:"Ellysion Panel",link:"/dashboard"},{title:"Booklet",link:"/dashboard/booklet"}];function w({auth:e,response:s}){const l=[{id:"no",header:"No",cell:({row:e})=>e.index+1},{id:"nama_booklet",accessorKey:"booklet.nama_booklet",header:"Nama"},{id:"url_booklet",accessorKey:"booklet.url_booklet",header:"Link Booklet"},{id:"action",header:"Aksi",cell:({row:e})=>o.jsx(B,{booklet:e.original.booklet})}];return o.jsxs(o.Fragment,{children:[o.jsx(t,{title:"Atur Booklet"}),o.jsxs(a,{user:e.user,children:[o.jsx(b,{items:N}),o.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Atur Booklet"}),o.jsx("div",{className:"place-content-start flex w-full",children:o.jsxs(h,{children:[o.jsx(p,{asChild:!0,children:o.jsxs(i,{children:[o.jsx(v,{size:18}),o.jsx("span",{children:"Tambah Booklet"})]})}),o.jsxs(j,{className:"border-none",children:[o.jsx(x,{children:o.jsx(u,{children:"Tambah Booklet"})}),o.jsx(y,{})]})]})}),o.jsx(g,{searchKey:"name",columns:l,apiEndpoint:route("dashboard.booklet.data"),title:"Data Booklet",description:"Kelola data booklet untuk mahasiswa baru"}),o.jsx(f,{})]})]})}export{w as default};
