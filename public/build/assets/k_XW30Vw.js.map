{"version":3,"file":"k_XW30Vw.js","sources":["../../../resources/js/Pages/Relasi/Search/Page.tsx"],"sourcesContent":["import Autoplay from \"embla-carousel-autoplay\";\nimport { useSearchParams } from \"react-router-dom\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { UserPlus } from \"lucide-react\";\n\nimport { IconChevronLeft, IconChevronRight } from \"@tabler/icons-react\";\n\nimport Footer from \"@/Components/Footer\";\nimport Navbar from \"@/Components/Navbar\";\nimport RelasiLoading from \"@/Components/relasi/RelasiLoading\";\nimport RelasiSearch from \"@/Components/relasi/RelasiSearch\";\nimport UserList from \"@/Components/relasi/UserList\";\nimport { Button } from \"@/Components/ui/button\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { fetchSearch } from \"@/lib/data/relasi\";\nimport { useAos } from \"@/lib/hooks/useAos\";\nimport { User } from \"@/lib/types/User\";\nimport { UserSearchResponse } from \"@/lib/types/UserSearchResponse\";\n\nfunction Page() {\n  useAos();\n\n  const toast = useToast();\n  const [searchLoading, setSearchLoading] = useState(false);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [searchResponse, setSearchResponse] = useState<UserSearchResponse>();\n  const [users, setUsers] = useState<Partial<User>[]>([]);\n  const [search, setSearch] = useState(\"\");\n  const [searchTitle, setSearchTitle] = useState<string>(\n    \"Cari Naramuda Lainnya!\",\n  );\n\n  async function mFetchSearch(\n    mSearch: string = \"\",\n    page: number = currentPage,\n  ) {\n    if (!mSearch) return;\n    if (mSearch.length > 100) {\n      toast.toast({\n        title: \"Gagal mencari Naramuda...\",\n        description: \"Kata kunci terlalu panjang\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (/[^a-zA-Z0-9_ ]/g.test(mSearch)) {\n      toast.toast({\n        title: \"Gagal mencari Naramuda...\",\n        description: \"Kata kunci hanya boleh berupa huruf dan angka\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // set search to url query params\n    let url = new URL(window.location.href);\n    url.searchParams.set(\"search\", mSearch);\n    window.history.pushState({}, \"\", url.toString());\n\n    if (search != mSearch) {\n      setCurrentPage(1);\n    }\n\n    setSearch(mSearch);\n    setSearchLoading(true);\n    let response = await fetchSearch(mSearch, page);\n    setSearchResponse(response);\n    setUsers(response.data);\n    setSearchTitle(`Hasil Pencarian dari ${mSearch}`);\n    setSearchLoading(false);\n  }\n\n  useEffect(() => {\n    let s = new URLSearchParams(window.location.search).get(\"search\") ?? \"\";\n    setSearch(s);\n    mFetchSearch(s);\n  }, []);\n\n  useEffect(() => {\n    mFetchSearch(search, currentPage);\n  }, [currentPage]);\n\n  const getPaginationRange = () => {\n    let range: Array<number> = [];\n    let start = Math.max(1, currentPage - 2);\n    let end = Math.min(searchResponse?.last_page ?? 0, start + 4);\n    for (let i = start; i <= end; i++) {\n      range.push(i);\n    }\n    return range;\n  };\n\n  return (\n    <div className=\"bg-pattern-white flex flex-col w-full min-h-screen\">\n      <div>\n        <Navbar isSolid={true} isFixed={false} />\n\n        <div className=\"max-w-7xl md:pt-24 lg:pt-32 font-montserrat md:text-md flex flex-col gap-8 px-2 py-16 pt-10 mx-auto text-base text-black\">\n          <div className=\"relative w-full max-w-3xl mx-auto\">\n            <RelasiSearch onsubmit={(search) => mFetchSearch(search, 1)} />\n          </div>\n          {searchLoading ? (\n            <RelasiLoading className=\"min-h-72 w-full\" />\n          ) : (\n            <div className=\"w-full max-w-5xl mx-auto\">\n              <div className=\"place-content-center place-items-center flex\">\n                <h4 className=\"lg:text-2xl text-lg font-bold text-center\">\n                  {searchTitle}\n                </h4>\n              </div>\n              {users.length > 0 ? (\n                <UserList users={users} />\n              ) : (\n                <div className=\"text-wrap mx-auto my-16 text-sm text-center\">\n                  Maaf, kami tidak dapat menemukan Naramuda yang kamu cari ðŸ˜•\n                </div>\n              )}\n            </div>\n          )}\n\n          <ul className=\"place-content-center flex flex-wrap gap-2 mx-auto\">\n            <li>\n              <Button\n                onClick={() => setCurrentPage(Math.max(currentPage - 1, 1))}\n                className=\"bg-gradient-to-br from-jaffa-600 to-jaffa-700 hover:scale-110 transition\"\n              >\n                <IconChevronLeft></IconChevronLeft>\n              </Button>\n            </li>\n\n            {getPaginationRange().map((page) => (\n              <li key={page}>\n                <Button\n                  className=\" bg-gradient-to-br from-jaffa-600 to-jaffa-700 hover:scale-110 transition\"\n                  onClick={() => setCurrentPage(page)}\n                >\n                  {page}\n                </Button>\n              </li>\n            ))}\n\n            <li>\n              <Button\n                onClick={() =>\n                  setCurrentPage(\n                    Math.min(currentPage + 1, searchResponse?.last_page ?? 1),\n                  )\n                }\n                className=\" bg-gradient-to-br from-jaffa-600 to-jaffa-700 hover:scale-110 transition\"\n              >\n                <IconChevronRight></IconChevronRight>\n              </Button>\n            </li>\n          </ul>\n          <p className=\"text-center\">\n            Halaman {currentPage} dari {searchResponse?.last_page ?? 1}\n          </p>\n        </div>\n\n        <Footer />\n      </div>\n\n      <Toaster />\n    </div>\n  );\n}\n\nexport default Page;\n"],"names":["Page","useAos","toast","useToast","searchLoading","setSearchLoading","useState","currentPage","setCurrentPage","searchResponse","setSearchResponse","users","setUsers","search","setSearch","searchTitle","setSearchTitle","async","mFetchSearch","mSearch","page","length","title","description","variant","test","url","URL","window","location","href","searchParams","set","history","pushState","toString","response","fetchSearch","data","useEffect","s","URLSearchParams","get","jsxs","className","children","jsx","Navbar","isSolid","isFixed","RelasiSearch","onsubmit","RelasiLoading","UserList","Button","onClick","Math","max","IconChevronLeft","range","start","end","min","last_page","i","push","getPaginationRange","map","IconChevronRight","Footer","Toaster"],"mappings":"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"}