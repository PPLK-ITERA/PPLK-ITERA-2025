import{G as e,r as a,j as i,S as s}from"./abp7IuU_.js";import{D as r}from"./7ZM37BCG.js";import{D as t}from"./Cbvh-po1.js";import{c as n}from"./DRv3bph6.js";import{B as l}from"./Cj0nWcQ-.js";import{I as m}from"./fr_-dOtV.js";import{L as o}from"./CCCylx0_.js";import{t as d}from"./DubPlji4.js";import{D as c,f as h,a as p,b as j,c as x}from"./hv2IETaQ.js";import{I as u}from"./Sig6w_ZG.js";import{B as g}from"./BF575S6V.js";import{D as f}from"./CtS4a1qg.js";import{T as k}from"./BoIUxSNb.js";import{I as b}from"./aL-Jr4x0.js";import"./_fO5z9yw.js";import"./H8YkMc3c.js";import"./BtX5GCkJ.js";import"./CcG4o7X6.js";import"./Dzr7GVJH.js";import"./BlFTosi-.js";import"./DbEfBH51.js";import"./CvvzBKdu.js";import"./CWPnhICS.js";import"./C0u18CNn.js";import"./CKIXoJcH.js";import"./C-xJ0Qzn.js";import"./BZthcdMp.js";import"./D7jUei3D.js";import"./OkJ3yrDP.js";function N({materi:s}){const{data:r,setData:t,post:c,put:h,errors:p}=e(s),[j,x]=a.useState(null),[u,g]=a.useState(null),f=n((async()=>{if(!/^https:\/\/(www\.)?\w+\.google\.com\/.*$/g.test(r.link_materi))return void x("link harus dari Google Drive");let e=r.link_materi.split("/")[5];(await fetch(`https://www.googleapis.com/drive/v2/files/${e}?key=AIzaSyBhQpkTndFEvQEvUCY0MegZhYII5fqgUcQ`)).ok?x(""):x("Link drive belum publik, silahkan coba lagi")}),200);return i.jsxs("form",{"aria-describedby":"form",className:"grid gap-4 py-4",onSubmit:e=>{e.preventDefault(),d({title:"Mohon tunggu sebentar...",description:"Sedang mengupload Materi..."}),s?(h(route("dashboard.materi.update"),{onError:()=>{d({title:"Uh oh! Gagal mengupdate Materi.",description:p.nama_materi||p.link_materi})},onSuccess:()=>{d({title:"Berhasil!",description:"Materi berhasil diupdate."})}}),window.location.reload()):(c(route("dashboard.materi.store"),{onError:()=>{d({title:"Uh oh! Gagal mengupload Materi.",description:p.nama_materi||p.link_materi})},onSuccess:()=>{d({title:"Berhasil!",description:"Materi berhasil diupload."})}}),window.location.reload())},children:[i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"nama_materi",className:"text-right",children:"Nama Materi"}),i.jsx(m,{id:"nama_materi",name:"nama_materi",required:!0,type:"text",value:r.nama_materi,maxLength:500,className:"col-span-3",onChange:e=>t("nama_materi",e.target.value)})]}),i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"hari",className:"text-right",children:"Hari Ke-"}),i.jsx(m,{id:"hari",name:"hari",required:!0,type:"text",value:r.hari,maxLength:1,className:"col-span-3",onChange:e=>{t("hari",e.target.value)}})]}),i.jsxs("div",{className:"grid items-center grid-cols-4 gap-4",children:[i.jsx(o,{htmlFor:"link_materi",className:"text-right",children:"Link Google Drive Materi"}),i.jsx(m,{id:"link_materi",name:"link_materi",required:!0,type:"text",value:r.link_materi,maxLength:500,className:"col-span-3",onChange:e=>{t("link_materi",e.target.value),f()}})]}),i.jsxs("div",{className:"place-content-center flex items-center justify-between gap-4 text-right",children:[i.jsx(l,{className:"bg-orange-500",size:"sm",type:"button",onClick:f,children:"Refresh Link"}),j?i.jsx("p",{className:"text-sm text-red-500",children:j}):""===j?i.jsx("p",{className:"text-sm text-green-500",children:"Link valid"}):null]}),i.jsx("div",{className:"place-content-center flex items-center justify-between gap-4 mt-4 text-right",children:i.jsxs(l,{size:"sm",type:"submit",className:"w-full",disabled:!!j||!!u,children:[s?"Perbarui":"Tambahkan"," Materi"]})})]})}const v=({materi:s})=>{const{setData:r,delete:n,errors:m}=e(s),[o,g]=a.useState(!1),[f,k]=a.useState(!1);return a.useEffect((()=>{(o||f)&&r(s)}),[o,f,s,r]),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"flex gap-1 p-2",children:[i.jsxs(c,{open:o,onOpenChange:g,children:[i.jsx(h,{asChild:!0,children:i.jsxs(l,{className:"bg-red-500",onClick:()=>g(!0),children:[i.jsx(u,{size:18}),i.jsx("span",{children:"Hapus"})]})}),i.jsxs(p,{className:"sm:max-w-[425px]",children:[i.jsx(j,{children:i.jsx(x,{children:"Hapus Materi"})}),i.jsxs("div",{children:[i.jsxs("p",{children:["Apakah anda yakin ingin menghapus materi ",s.nama_materi,"?"]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx(t,{asChild:!0,children:i.jsx(l,{children:"Batal"})}),i.jsx(l,{onClick:function(){n(route("dashboard.materi.destroy"),{onError:()=>{d({title:"Uh oh! Gagal menghapus Materi.",description:m.nama_materi||m.link_materi})},onSuccess:()=>{d({title:"Berhasil!",description:"Materi berhasil dihapus."})}}),window.location.reload()},className:"bg-red-500",children:"Hapus"})]})]})]})]}),i.jsxs(c,{open:f,onOpenChange:k,children:[i.jsx(h,{asChild:!0,children:i.jsx(l,{onClick:()=>k(!0),children:i.jsx("span",{children:"Edit"})})}),i.jsxs(p,{className:"sm:max-w-[425px]",children:[i.jsx(j,{children:i.jsx(x,{children:"Edit Materi"})}),i.jsx(N,{materi:s})]})]})]})})},w=[{title:"Ellysion Panel",link:"/dashboard"},{title:"Materi",link:"/dashboard/materi"}];function _({auth:e,response:a}){const t=[{id:"no",header:"No",cell:({row:e})=>e.index+1},{id:"nama_materi",accessorKey:"materi.nama_materi",header:"Nama"},{id:"link_materi",accessorKey:"materi.link_materi",header:"Link Materi"},{id:"hari",accessorKey:"materi.hari",header:"Hari Ke"},{id:"action",header:"Aksi",cell:({row:e})=>i.jsx(v,{materi:e.original.materi})}];return i.jsxs(i.Fragment,{children:[i.jsx(s,{title:"Atur Materi"}),i.jsxs(r,{user:e.user,children:[i.jsx(g,{items:w}),i.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Atur Materi"}),i.jsx("div",{className:"place-content-start flex w-full",children:i.jsxs(c,{children:[i.jsx(h,{asChild:!0,children:i.jsxs(l,{children:[i.jsx(b,{size:18}),i.jsx("span",{children:"Tambah Materi"})]})}),i.jsxs(p,{children:[i.jsx(j,{children:i.jsx(x,{children:"Tambah Materi"})}),i.jsx(N,{})]})]})}),i.jsx(f,{searchKey:"name",columns:t,apiEndpoint:route("dashboard.materi.data"),title:"Data Materi",description:"Data Materi yang telah diupload."}),i.jsx(k,{})]})]})}export{_ as default};
