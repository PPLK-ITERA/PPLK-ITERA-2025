{"version":3,"file":"CgneUvIA.js","sources":["../../../resources/js/Pages/Dashboard/absensi-maba/absensi/Page.tsx"],"sourcesContent":["import QRScanner from \"./QRScanner\";\nimport { IDetectedBarcode, Scanner, outline } from \"@yudiel/react-qr-scanner\";\n\nimport React, { useEffect, useState } from \"react\";\n\nimport { Link, router, useForm, usePage } from \"@inertiajs/react\";\n\nimport DashboardLayout from \"@/Layouts/DashboardLayout\";\n\nimport { Button, buttonVariants } from \"@/Components/ui/button\";\nimport { Toaster } from \"@/Components/ui/toaster\";\nimport { useToast } from \"@/Components/ui/use-toast\";\n\nimport { useFlashToast } from \"@/lib/hooks/useFlashToast\";\n\nfunction Page({ auth }) {\n  const { toast } = useToast();\n\n  const [csrfToken, setCsrfToken] = useState(\"\");\n  const [result, setResult] = useState<string>(\"\");\n  const [error, setError] = useState<string>(\"\");\n  const [loading, setLoading] = useState(false);\n  const { data, setData, post, processing } = useForm({\n    qr_code: \"\",\n  });\n\n  const handleScan = async (data: string) => {\n    if (data) {\n      try {\n        const response = await fetch(route(\"dashboard.presensi.scan\"), {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-CSRF-TOKEN\": csrfToken,\n          },\n          body: JSON.stringify({\n            qr_code: data,\n          }),\n        });\n\n        const getResult = await response.json();\n        //  //console.log(getResult.response);\n\n        if (getResult.response.status === 200) {\n          toast({\n            title: \"Presensi Berhasil\",\n            variant: \"default\",\n            description: getResult.response.message,\n          });\n        } else {\n          toast({\n            title: \"Presensi Gagal\",\n            variant: \"destructive\",\n            description: getResult.response.message,\n          });\n        }\n      } catch (error) {\n        console.error(\"Error:\", error);\n      }\n    }\n  };\n\n  useEffect(() => {\n    // Fungsi untuk mendapatkan token CSRF dari API\n    const fetchCsrfToken = async () => {\n      try {\n        const response = await fetch(route(\"csrf\"));\n        const data = await response.json();\n        setCsrfToken(data.csrfToken);\n      } catch (error) {\n        console.error(\"Error fetching CSRF token:\", error);\n      }\n    };\n\n    fetchCsrfToken();\n  }, []);\n\n  useEffect(() => {\n    if (data.qr_code) {\n      handleScan(data.qr_code);\n    }\n  }, [data.qr_code]);\n\n  return (\n    <>\n      <DashboardLayout user={auth.user}>\n        <div className=\"relative flex flex-col items-center justify-center w-full h-full\">\n          <div className=\"md:w-[100%] w-[75vw] h-[70vh] items-center justify-center\">\n            <h2 className=\"text-xl font-bold tracking-tight text-center\">\n              Absensi QR SCAN Maba\n            </h2>\n\n            {loading ? (\n              <div className=\"border-b-purple-900 flex items-center justify-center w-full h-full\">\n                LOADING\n              </div>\n            ) : (\n              <div className=\"flex items-center justify-center w-full\">\n                <div className=\"md:w-64\">\n                  <Scanner\n                    onScan={function (detectedCodes: IDetectedBarcode[]): void {\n                      //  //console.log(detectedCodes.at(-1)?.rawValue);\n                      handleScan(detectedCodes.at(-1)?.rawValue || \"\");\n                      //  //console.log(detectedCodes);\n                    }}\n                    components={{\n                      finder: true,\n                      tracker: outline,\n                      zoom: true,\n                    }}\n                    allowMultiple={true}\n                    scanDelay={2000}\n                    paused={loading}\n                    styles={{\n                      container: {\n                        width: \"100%\",\n                      },\n                    }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n          <Link href={\"/dashboard/absensi-maba\"} className={buttonVariants()}>\n            Absen Manual\n          </Link>\n          {result && (\n            <p className=\"md:block hidden\">Scanned Result: {result}</p>\n          )}\n        </div>\n      </DashboardLayout>\n      <Toaster />\n    </>\n  );\n}\n\nexport default Page;\n"],"names":["Page","auth","toast","useToast","csrfToken","setCsrfToken","useState","result","setResult","error","setError","loading","setLoading","data","useForm","qr_code","handleScan","async","response","fetch","route","method","headers","body","JSON","stringify","getResult","json","status","title","variant","description","message","console","useEffect","fetchCsrfToken","jsxs","Fragment","children","jsx","DashboardLayout","user","className","Scanner","onScan","detectedCodes","_a","at","rawValue","components","finder","tracker","outline","zoom","allowMultiple","scanDelay","paused","styles","container","width","Link","href","buttonVariants","Toaster"],"mappings":"gfAeA,SAASA,GAAKC,KAAEA,IACd,MAAMC,MAAEA,GAAUC,KAEXC,EAAWC,GAAgBC,EAAAA,SAAS,KACpCC,EAAQC,GAAaF,EAAAA,SAAiB,KACtCG,EAAOC,GAAYJ,EAAAA,SAAiB,KACpCK,EAASC,GAAcN,EAAAA,UAAS,IACjCO,KAAEA,GAAoCC,EAAQ,CAClDC,QAAS,KAGLC,EAAaC,MAAOJ,IACxB,GAAIA,EACF,IACE,MAAMK,QAAiBC,MAAMC,MAAM,2BAA4B,CAC7DC,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,eAAgBlB,GAElBmB,KAAMC,KAAKC,UAAU,CACnBV,QAASF,MAIPa,QAAkBR,EAASS,OAGC,MAA9BD,EAAUR,SAASU,OACrB1B,EAAM,CACJ2B,MAAO,oBACPC,QAAS,UACTC,YAAaL,EAAUR,SAASc,UAGlC9B,EAAM,CACJ2B,MAAO,iBACPC,QAAS,cACTC,YAAaL,EAAUR,SAASc,SAGtC,OAASvB,GACPwB,QAAQxB,MAAM,SAAUA,EAC1B,CACF,EAwBF,OArBAyB,EAAAA,WAAU,KAEejB,WACrB,IACE,MAAMC,QAAiBC,MAAMC,MAAM,SAC7BP,QAAaK,EAASS,OAC5BtB,EAAaQ,EAAKT,UACpB,OAASK,GACPwB,QAAQxB,MAAM,6BAA8BA,EAC9C,GAGF0B,EAAA,GACC,IAEHD,EAAAA,WAAU,KACJrB,EAAKE,SACPC,EAAWH,EAAKE,QAClB,GACC,CAACF,EAAKE,UAGPqB,EAAAA,KAAAC,WAAA,CACEC,SAAA,CAAAC,EAAAA,IAACC,GAAgBC,KAAMxC,EAAKwC,KAC1BH,SAAAF,EAAAA,KAAC,MAAA,CAAIM,UAAU,mEACbJ,SAAA,GAAAF,KAAC,MAAA,CAAIM,UAAU,4DACbJ,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGG,UAAU,+CAA+CJ,SAAA,yBAI5D3B,EACC4B,EAAAA,IAAC,MAAA,CAAIG,UAAU,qEAAqEJ,SAAA,YAIpFC,EAAAA,IAAC,MAAA,CAAIG,UAAU,0CACbJ,SAAAC,EAAAA,IAAC,MAAA,CAAIG,UAAU,UACbJ,SAAAC,EAAAA,IAACI,EAAA,CACCC,OAAQ,SAAUC,SAEhB7B,GAAW,OAAA8B,IAAcC,IAAG,SAAjB,EAAAD,EAAsBE,WAAY,GAE/C,EACAC,WAAY,CACVC,QAAQ,EACRC,QAASC,EACTC,MAAM,GAERC,eAAe,EACfC,UAAW,IACXC,OAAQ7C,EACR8C,OAAQ,CACNC,UAAW,CACTC,MAAO,wBAQpBC,EAAA,CAAKC,KAAM,0BAA2BnB,UAAWoB,IAAkBxB,SAAA,iBAGnE/B,GACC6B,EAAAA,KAAC,IAAA,CAAEM,UAAU,kBAAkBJ,SAAA,CAAA,mBAAiB/B,gBAIrDwD,EAAA,CAAA,KAGP"}