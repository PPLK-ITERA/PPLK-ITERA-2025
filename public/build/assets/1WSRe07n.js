import{r as a,j as s,Y as e,y as l}from"./DRj7zCk5.js";import{D as r}from"./DqEJDm8Y.js";import{B as n}from"./LAGLuRE0.js";import{B as i}from"./DmFNtMt-.js";import{C as t,b as d,c,a as o}from"./BKqEFmmC.js";import{T as m,b as h,c as x,a as j}from"./CYe5QKXI.js";import{T as u}from"./D2CuH27Z.js";import"./C7v3s08o.js";import"./BRJeEc08.js";import"./fJglnZgp.js";import"./DExNkz5Y.js";import"./CO9J5KBW.js";import"./CFUqI47n.js";import"./BQfcUBB5.js";import"./Ule_K5uO.js";import"./BCp3v9py.js";import"./Dp938rFo.js";import"./C0u18CNn.js";import"./BSbnqClG.js";const p=[{title:"Ellysion Panel",link:"/dashboard"},{title:"Komdis",link:"/dashboard/komdis"}];function g({auth:g,logs:b,userData:k,redirectToInput:N}){const[v,f]=a.useState(N?"input":"list"),[y,S]=a.useState(k||null),[w,D]=a.useState("");return s.jsxs(s.Fragment,{children:[s.jsx(e,{title:"Log Komdis"}),s.jsxs(r,{user:g.user,children:[s.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4",children:"Log Komdis"}),s.jsx(n,{items:p}),s.jsxs(m,{defaultValue:"list",value:v,onValueChange:f,className:"mt-4",children:[s.jsxs(h,{children:[s.jsx(x,{value:"list",children:"Daftar Pelanggaran"}),s.jsx(x,{value:"scan",children:"Scan QR"}),y&&s.jsx(x,{value:"input",children:"Isi Kesalahan"})]}),s.jsx(j,{value:"list",children:s.jsxs(t,{className:"mt-4",children:[s.jsx(d,{children:s.jsx(c,{children:"Data Pelanggaran"})}),s.jsx(o,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left border-b",children:[s.jsx("th",{className:"p-2",children:"Nama"}),s.jsx("th",{className:"p-2",children:"NIM"}),s.jsx("th",{className:"p-2",children:"Kesalahan"}),s.jsx("th",{className:"p-2",children:"Status"}),s.jsx("th",{className:"p-2",children:"Tanggal"}),s.jsx("th",{className:"p-2",children:"Aksi"})]})}),s.jsx("tbody",{children:b.map((a=>{var e,r;return s.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[s.jsx("td",{className:"p-2",children:null==(e=a.user)?void 0:e.name}),s.jsx("td",{className:"p-2",children:null==(r=a.user)?void 0:r.nim}),s.jsx("td",{className:"p-2",children:a.kesalahan}),s.jsx("td",{className:"p-2",children:s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("selesai"===a.status?"bg-green-100 text-green-800":"proses"===a.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:a.status||"belum diproses"})}),s.jsx("td",{className:"p-2",children:new Date(a.created_at).toLocaleDateString("id-ID")}),s.jsx("td",{className:"p-2",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(i,{size:"sm",onClick:()=>{return s=a.id,void l.get(route("dashboard.komdis.edit",s));var s},className:"bg-gray-900 hover:bg-gray-800 text-white border-0 px-3 py-1.5 rounded-md",children:"Edit"}),s.jsx(i,{size:"sm",onClick:()=>{return s=a.id,void(confirm("Yakin ingin menghapus data komdis ini?")&&l.delete(route("dashboard.komdis.destroy",s),{onSuccess:()=>{window.location.reload()},onError:a=>{alert("Gagal menghapus data")}}));var s},className:"bg-red-500 hover:bg-red-600 text-white border-0 px-3 py-1.5 rounded-md",children:"Delete"})]})})]},a.id)}))})]})})})]})}),s.jsx(j,{value:"scan",children:s.jsx("div",{className:"space-y-4",children:s.jsxs(t,{className:"mt-4",children:[s.jsx(d,{children:s.jsx(c,{children:"Scan QR Code dengan Kamera"})}),s.jsxs(o,{className:"text-center",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"Klik tombol di bawah untuk membuka halaman QR scanner"}),s.jsx(i,{onClick:()=>l.get(route("dashboard.komdis.scanner")),className:"w-full",size:"lg",children:"ðŸ“· Buka QR Scanner"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-4 space-y-1",children:[s.jsx("p",{children:"â€¢ Scanner akan membuka halaman terpisah"}),s.jsx("p",{children:"â€¢ Arahkan kamera ke QR code mahasiswa"}),s.jsx("p",{children:"â€¢ Hasil scan otomatis akan kembali ke halaman ini"})]})]})]})})}),s.jsx(j,{value:"input",children:s.jsxs(t,{className:"mt-4",children:[s.jsx(d,{children:s.jsxs(c,{children:["Isi Kesalahan untuk ",(null==y?void 0:y.name)||(null==y?void 0:y.nama)," (",null==y?void 0:y.nim,")"]})}),s.jsx(o,{children:s.jsxs("form",{onSubmit:a=>{a.preventDefault(),l.post("/dashboard/komdis/store",{user_id:y.id,kesalahan:w},{onSuccess:()=>{D(""),S(null),f("list")},onError:a=>{console.error("Submit errors:",a),alert(a.kesalahan||"Terjadi kesalahan")}})},className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kesalahan/Pelanggaran:"}),s.jsx(u,{placeholder:"Masukkan detail kesalahan atau pelanggaran yang dilakukan",value:w,onChange:a=>D(a.target.value),required:!0,rows:4})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(i,{type:"submit",disabled:!w.trim(),children:"Simpan Data"}),s.jsx(i,{type:"button",variant:"outline",onClick:()=>{S(null),D(""),f("scan")},children:"Batal"})]})]})})]})})]})]})]})}export{g as default};
